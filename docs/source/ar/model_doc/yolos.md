# YOLOS

## ูุธุฑุฉ ุนุงูุฉ

ุงูุชุฑุญ ูููุฐุฌ YOLOS ูู ูุฑูุฉ ุจุญุซูุฉ ุจุนููุงู "You Only Look at One Sequence: Rethinking Transformer in Vision through Object Detection" ุจูุงุณุทุฉ Yuxin Fang ูุขุฎุฑูู. ูุณุชููู YOLOS ููุฑุชู ูู DETRุ ูููุชุฑุญ ุงูุงุณุชูุงุฏุฉ ูู ูุญูู ุงูุฑุคูุฉ (ViT) ุงูุจุณูุท ูููุดู ุนู ุงูุฃุฌุณุงู. ููุฏ ุชุจูู ุฃู ูุญูู ุงูุชุฑููุฒ ููุท ุจุญุฌู ุงููุงุนุฏุฉ ูููู ุฃู ูุญูู 42 AP ุนูู COCOุ ููู ูุง ูุดุจู ุฃุฏุงุก DETR ูุฃุทุฑ ุงูุนูู ุงูุฃูุซุฑ ุชุนููุฏูุง ูุซู Faster R-CNN.

ูููุง ููู ุงูููุฎุต ุงููุณุชุฎุฑุฌ ูู ุงููุฑูุฉ ุงูุจุญุซูุฉ:

*ูู ูููู ููุญูู Transformer ุฃู ูุคุฏู ุงูุชุนุฑู ุนูู ุงููุณุชูู ุซูุงุฆู ุงูุฃุจุนุงุฏ ููุฃุฌุณุงู ูุงูููุงุทู ูู ููุธูุฑ ุชุณูุณู ููู ุฅูู ุชุณูุณู ูุน ูุนุฑูุฉ ููููุฉ ุจูููู ุงููุถุงุก ุซูุงุฆู ุงูุฃุจุนุงุฏุ ููุฅุฌุงุจุฉ ุนูู ูุฐุง ุงูุณุคุงูุ ููุฏู "You Only Look at One Sequence (YOLOS)"ุ ููู ุณูุณูุฉ ูู ููุงุฐุฌ ุงููุดู ุนู ุงูุฃุฌุณุงู ุงููุณุชูุฏุฉ ุฅูู ูุญูู ุงูุฑุคูุฉ ุงูุฃุณุงุณู ูุน ุฃูู ุนุฏุฏ ูููู ูู ุงูุชุนุฏููุงุชุ ูุฃููููุงุช ุงูููุงุทูุ ููุฐูู ุงูุงูุญูุงุฒุงุช ุงูุงุณุชูุฑุงุฆูุฉ ููููุฉ ุงููุฏู. ููุฌุฏูุง ุฃู YOLOS ุงูุฐู ุชู ุชุฏุฑูุจู ูุณุจููุง ุนูู ูุฌููุนุฉ ุจูุงูุงุช ImageNet-1k ุฐุงุช ุงูุญุฌู ุงููุชูุณุท ููุท ูููู ุฃู ูุญูู ุฃุฏุงุกู ุชูุงูุณููุง ููุบุงูุฉ ูู ูุนูุงุฑ COCO ุงูุตุนุจ ูููุดู ุนู ุงูุฃุฌุณุงูุ ุนูู ุณุจูู ุงููุซุงูุ ูููู ูู YOLOS-Base ุงููุฃุฎูุฐ ูุจุงุดุฑุฉ ูู ุจููุฉ BERT-Base ุชุญููู 42.0 box AP ุนูู COCO val. ููุง ููุงูุด ุชุฃุซูุฑุงุช ููุญุฏูุฏูุงุช ูุฎุทุทุงุช ุงูุชุฏุฑูุจ ุงููุณุจู ุงูุญุงููุฉ ูุงุณุชุฑุงุชูุฌูุงุช ุชูุณูุน ูุทุงู ุงููููุฐุฌ ููุญูู Transformer ูู ุงูุฑุคูุฉ ูู ุฎูุงู YOLOS.*

<img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/yolos_architecture.png" alt="drawing" width="600"/>

<small>ููุฏุณุฉ YOLOS. ูุฃุฎูุฐุฉ ูู <a href="https://arxiv.org/abs/2106.00666">ุงููุฑูุฉ ุงูุจุญุซูุฉ ุงูุฃุตููุฉ</a>.</small>

ุชูุช ุงููุณุงููุฉ ุจูุฐุง ุงููููุฐุฌ ุจูุงุณุทุฉ [nielsr](https://huggingface.co/nielsr). ูููู ุงูุนุซูุฑ ุนูู ุงูููุฏ ุงูุฃุตูู [ููุง](https://github.com/hustvl/YOLOS).

## ุงุณุชุฎุฏุงู Scaled Dot Product Attention (SDPA)

ุชุชุถูู PyTorch ูุดุบู ุงูุชูุงู ุงูููุชุฌ ุงูููุทู ุงููููุฒ (SDPA) ุงูุฃุตูู ูุฌุฒุก ูู `torch.nn.functional`. ุชุดูู ูุฐู ุงููุธููุฉ ุนุฏุฉ ุชูููุฐุงุช ูููู ุชุทุจูููุง ุงุนุชูุงุฏูุง ุนูู ุงููุฏุฎูุงุช ูุงูุฃุฌูุฒุฉ ุงููุณุชุฎุฏูุฉ. ุฑุงุฌุน [ุงููุซุงุฆู ุงูุฑุณููุฉ](https://pytorch.org/docs/stable/generated/torch.nn.functional.scaled_dot_product_attention.html) ุฃู ุตูุญุฉ [GPU Inference](https://huggingface.co/docs/transformers/main/en/perf_infer_gpu_one#pytorch-scaled-dot-product-attention) ููุฒูุฏ ูู ุงููุนูููุงุช.

ูุชู ุงุณุชุฎุฏุงู SDPA ุจุดูู ุงูุชุฑุงุถู ูู `torch>=2.1.1` ุนูุฏูุง ูููู ุงูุชูููุฐ ูุชุงุญูุงุ ูููู ููููู ุฃูุถูุง ุชุนููู `attn_implementation="sdpa"` ูู `from_pretrained()` ูุทูุจ ุงุณุชุฎุฏุงู SDPA ุจุดูู ุตุฑูุญ.

```py
from transformers import AutoModelForObjectDetection
model = AutoModelForObjectDetection.from_pretrained("hustvl/yolos-base", attn_implementation="sdpa", torch_dtype=torch.float16)
...
```

ููุญุตูู ุนูู ุฃูุถู ุงูุชุญุณููุงุช ูู ุงูุณุฑุนุฉุ ููุตู ุจุชุญููู ุงููููุฐุฌ ุจูุตู ุงูุฏูุฉ (ูุซู `torch.float16` ุฃู `torch.bfloat16`).

ุนูู ูุนูุงุฑ ููุงุณ ูุญูู (A100-40GBุ PyTorch 2.3.0ุ ูุธุงู ุงูุชุดุบูู Ubuntu 22.04) ูุน `float32` ููููุฐุฌ `hustvl/yolos-base`ุ ูุงุญุธูุง ุงูุชุญุณููุงุช ูู ุงูุณุฑุนุฉ ุงูุชุงููุฉ ุฃุซูุงุก ุงูุงุณุชูุชุงุฌ.

| ุญุฌู ุงูุฏูุนุฉ | ูุชูุณุท ููุช ุงูุงุณุชูุชุงุฌ (ูููู ุซุงููุฉ)ุ ูุถุน Eager | ูุชูุณุท ููุช ุงูุงุณุชูุชุงุฌ (ูููู ุซุงููุฉ)ุ ูููุฐุฌ SDPA | ุชุณุฑูุนุ SDPA / Eager (x) |
|--------------|-------------------------------------------|-------------------------------------------|------------------------------|
| 1 | 106 | 76 | 1.39 |
| 2 | 154 | 90 | 1.71 |
| 4 | 222 | 116 | 1.91 |
| 8 | 368 | 168 | 2.19 |

## ุงูููุงุฑุฏ

ูููุง ููู ูุงุฆูุฉ ุจููุงุฑุฏ Hugging Face ุงูุฑุณููุฉ ูููุงุฑุฏ ุงููุฌุชูุน (ูุดุงุฑ ุฅูููุง ุจู ๐) ููุณุงุนุฏุชู ูู ุงูุจุฏุก ุจุงุณุชุฎุฏุงู YOLOS.

<PipelineTag pipeline="object-detection"/>

- ูููู ุงูุนุซูุฑ ุนูู ุฌููุน ุฏูุงุชุฑ ุงูููุงุญุธุงุช ุงูุชูุถูุญูุฉ ุงูุชู ุชูุถุญ ุงูุงุณุชุฏูุงู + ุงูุถุจุท ุงูุฏููู [`YolosForObjectDetection`] ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ [ููุง](https://github.com/NielsRogge/Transformers-Tutorials/tree/master/YOLOS).
- ูููู ุงูุนุซูุฑ ุนูู ุงููุตูุต ุงูุจุฑูุฌูุฉ ููุถุจุท ุงูุฏููู [`YolosForObjectDetection`] ุจุงุณุชุฎุฏุงู [`Trainer`] ุฃู [Accelerate](https://huggingface.co/docs/accelerate/index) [ููุง](https://github.com/huggingface/transformers/tree/main/examples/pytorch/object-detection).
- ุฑุงุฌุน ุฃูุถูุง: [ุฏููู ููุงู ุงููุดู ุนู ุงูุฃุฌุณุงู](../tasks/object_detection)

ุฅุฐุง ููุช ููุชููุง ุจุชูุฏูู ููุฑุฏ ูุฅุฏุฑุงุฌู ููุงุ ููุฑุฌู ูุชุญ ุทูุจ ุณุญุจ ูุณูุฑุงุฌุนู! ูุฌุจ ุฃู ููุถุญ ุงูููุฑุฏ ุจุดูู ูุซุงูู ุดูุก ุฌุฏูุฏ ุจุฏูุงู ูู ุชูุฑุงุฑ ููุฑุฏ ููุฌูุฏ.

<Tip>

ุงุณุชุฎุฏู [`YolosImageProcessor`] ูุชุญุถูุฑ ุงูุตูุฑ (ูุงูุฃูุฏุงู ุงูุงุฎุชูุงุฑูุฉ) ูููููุฐุฌ. ุนูู ุนูุณ [DETR](detr)ุ ูุง ูุชุทูุจ YOLOS ุฅูุดุงุก `pixel_mask`.

</Tip>

## YolosConfig

[[autodoc]] YolosConfig

## YolosImageProcessor

[[autodoc]] YolosImageProcessor

- preprocess
- pad
- post_process_object_detection

## YolosFeatureExtractor

[[autodoc]] YolosFeatureExtractor

- __call__
- pad
- post_process_object_detection

## YolosModel

[[autodoc]] YolosModel

- forward

## YolosForObjectDetection

[[autodoc]] YolosForObjectDetection

- forward