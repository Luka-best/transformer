# ViTMSN

## ูุธุฑุฉ ุนุงูุฉ

ุงูุชูุฑุญ ูููุฐุฌ ViTMSN ูู ุงููุฑูุฉ ุงูุจุญุซูุฉ [Masked Siamese Networks for Label-Efficient Learning](https://arxiv.org/abs/2204.07141) ูู ูุจู ูุญููุฏ ุนุณุฑุงูุ ููุงุซููุฏ ูุงุฑููุ ูุฅูุดุงู ููุณุฑุงุ ูุจููุชุฑ ุจูุฌุงูููุณููุ ููููุฑูุงู ุจูุฑุฏูุณุ ูุจุงุณูุงู ูููุณูุชุ ูุฃุฑูุงูุฏ ุฌููููุ ููุงููู ุฑุงุจุงุชุ ููููููุงุณ ุจุงูุงุณ. ุชุนุฑุถ ุงููุฑูุฉ ุชุตููููุง ูุนูุงุฑููุง ููุชุนูู ุงููุดุชุฑู ูุชูุซูู ุงูููุงุฐุฌ ุงูุฃูููุฉ ููุฑูุนุงุช ุงููููุนุฉ ููุทุงุจูุชูุง ูุน ุงูุฑูุนุงุช ุบูุฑ ุงููููุนุฉ. ูุจูุถู ูุฐุง ุงูุฅุนุฏุงุฏุ ูุญูู ุฃุณููุจูู ุฃุฏุงุกู ููุชุงุฒูุง ูู ุฃูุธูุฉ ุงูุชุตููุฑ ููุฎูุถุฉ ูููููุฉ ููุบุงูุฉ.

ููุฎุต ุงููุฑูุฉ ุงูุจุญุซูุฉ ูู ููุง ููู:

*ูุญู ููุชุฑุญ ุดุจูุงุช Siamese ุงููููุนุฉ (MSN)ุ ููู ุฅุทุงุฑ ุนูู ููุชุนูู ุงูุฐุงุชู ููุฅุดุฑุงู ูุชุนูู ุชูุซููุงุช ุงูุตูุฑ. ููุงุฑู ููุฌูุง ุชูุซูู ุนุฑุถ ุตูุฑุฉ ุชุญุชูู ุนูู ุฑูุนุงุช ูููุนุฉ ุนุดูุงุฆููุง ุจุชูุซูู ุงูุตูุฑุฉ ุงูุฃุตููุฉ ุบูุฑ ุงููููุนุฉ. ุชุนุฏ ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนูู ุงููุณุจู ุฐุงุชู ุงูุฅุดุฑุงู ูุฐู ูุงุจูุฉ ููุชุทููุฑ ุจุดูู ุฎุงุต ุนูุฏ ุชุทุจูููุง ุนูู ูุญููุงุช ุงูุฑุคูุฉ ุญูุซ ุชููู ุงูุดุจูุฉ ุจูุนุงูุฌุฉ ุงูุฑูุนุงุช ุบูุฑ ุงููููุนุฉ ููุท. ููุชูุฌุฉ ูุฐููุ ุชุญุณู ุดุจูุงุช MSN ูุงุจููุฉ ุชูุณุน ุชุตูููุงุช ุงูุชุนูู ุงููุดุชุฑูุ ูุน ุฅูุชุงุฌ ุชูุซููุงุช ุฐุงุช ูุณุชูู ุฏูุงูู ุนุงูู ุชุชูุงูุณ ุจุดูู ูุนุงู ูู ุชุตููู ุงูุตูุฑ ููุฎูุถุฉ ุงูุชุตููุฑ. ุนูู ุณุจูู ุงููุซุงูุ ูู ImageNet-1Kุ ุจุงุณุชุฎุฏุงู 5000 ุตูุฑุฉ ููุทุ ูุญูู ูููุฐุฌ MSN ุงูุฃุณุงุณู ูุฏููุง ุฏูุฉ 72.4ูชุ ูุจุงุณุชุฎุฏุงู 1ูช ูู ููุตูุงุช ImageNet-1Kุ ูุญูู ุฏูุฉ 75.7ูชุ ููุง ูุญุฏุฏ ุญุงูุฉ ุฌุฏูุฏุฉ ูู ุงููู ููุชุนูู ุงูุฐุงุชู ููุฅุดุฑุงู ุนูู ูุฐุง ุงููุนูุงุฑ.*

<img src="https://i.ibb.co/W6PQMdC/Screenshot-2022-09-13-at-9-08-40-AM.png" alt="drawing" width="600"/>

<small> ุชุตููู MSN. ูุฃุฎูุฐุฉ ูู <a href="https://arxiv.org/abs/2204.07141">ุงููุฑูุฉ ุงูุจุญุซูุฉ ุงูุฃุตููุฉ.</a> </small>

ุณุงูู ุจูุฐุง ุงููููุฐุฌ [sayakpaul](https://huggingface.co/sayakpaul). ูููู ุงูุนุซูุฑ ุนูู ุงูููุฏ ุงูุฃุตูู [ููุง](https://github.com/facebookresearch/msn).

## ูุตุงุฆุญ ุงูุงุณุชุฎุฏุงู

- MSN (ุดุจูุงุช Siamese ุงููููุนุฉ) ูู ุทุฑููุฉ ููุชุนูู ุงููุณุจู ุฐุงุชู ุงูุฅุดุฑุงู ููุญููุงุช ุงูุฑุคูุฉ (ViTs). ูุชูุซู ุงููุฏู ูู ุงูุชุนูู ุงููุณุจู ูู ูุทุงุจูุฉ ุงูููุงุฐุฌ ุงูุฃูููุฉ ุงููุฎุตุตุฉ ูุทุฑู ุนุฑุถ ุงูุตูุฑ ุบูุฑ ุงููููุนุฉ ูุน ุทุฑู ุนุฑุถ ุงูุตูุฑ ุงููููุนุฉ ูููุณ ุงูุตูุฑ.

- ุฃุตุฏุฑ ุงููุคูููู ููุท ุงูุฃูุฒุงู ุงูููุฏุฑุจุฉ ูุณุจููุง ููุนููุฏ ุงูููุฑู (ุงูุชุฏุฑูุจ ุงููุณุจู ุนูู ImageNet-1k). ูุฐููุ ูุงุณุชุฎุฏุงู ุฐูู ูู ูุฌููุนุฉ ุจูุงูุงุช ุชุตููู ุงูุตูุฑ ุงูุฎุงุตุฉ ุจูุ ุงุณุชุฎุฏู ูุฆุฉ [`ViTMSNForImageClassification`] ุงูุชู ูุชู ุชููุฆุชูุง ูู [`ViTMSNModel`]. ุงุชุจุน [ุฏูุชุฑ ุงูููุงุญุธุงุช](https://github.com/huggingface/notebooks/blob/main/examples/image_classification.ipynb) ูุฐุง ููุญุตูู ุนูู ุชุนูููุงุช ููุตูุฉ ุญูู ุงูุถุจุท ุงูุฏููู.

- ุชุนุฏ MSN ูููุฏุฉ ุจุดูู ุฎุงุต ูู ุฃูุธูุฉ ุงูุชุตููุฑ ููุฎูุถุฉ ูููููุฉ ููุบุงูุฉ. ุนูู ูุฌู ุงูุฎุตูุตุ ูุญูู ุฏูุฉ 75.7ูช ูุน 1ูช ููุท ูู ููุตูุงุช ImageNet-1K ุนูุฏ ุถุจุทูุง ุงูุฏููู.

### ุงุณุชุฎุฏุงู Scaled Dot Product Attention (SDPA)

ุชุชุถูู PyTorch ูุดุบู ุงูุชูุงู ุงูููุงุท ุงููุญุฏุฏุฉ ุงููุญุฏุฏ ูุฌุฒุก ูู `torch.nn.functional`. ุชุดูู ูุฐู ุงููุธููุฉ ุนุฏุฉ ุชุทุจููุงุช ูููู ุชุทุจูููุง ุงุนุชูุงุฏูุง ุนูู ุงููุฏุฎูุงุช ูุงูุฃุฌูุฒุฉ ุงููุณุชุฎุฏูุฉ. ุฑุงุฌุน [ุงููุซุงุฆู ุงูุฑุณููุฉ](https://pytorch.org/docs/stable/generated/torch.nn.functional.scaled_dot_product_attention.html) ุฃู ุตูุญุฉ [GPU Inference](https://huggingface.co/docs/transformers/main/en/perf_infer_gpu_one#pytorch-scaled-dot-product-attention) ููุฒูุฏ ูู ุงููุนูููุงุช.

ูุชู ุงุณุชุฎุฏุงู SDPA ุจุดูู ุงูุชุฑุงุถู ูู `torch>=2.1.1` ุนูุฏ ุชููุฑ ุงูุชูููุฐุ ูููู ููููู ุฃูุถูุง ุชุนููู `attn_implementation="sdpa"` ูู `from_pretrained()` ูุทูุจ ุงุณุชุฎุฏุงู SDPA ุจุดูู ุตุฑูุญ.

```py
from transformers import ViTMSNForImageClassification
model = ViTMSNForImageClassification.from_pretrained("facebook/vit-msn-base", attn_implementation="sdpa", torch_dtype=torch.float16)
...
```

ููุญุตูู ุนูู ุฃูุถู ุงูุชุญุณููุงุชุ ููุตู ุจุชุญููู ุงููููุฐุฌ ุจูุตู ุงูุฏูุฉ (ุนูู ุณุจูู ุงููุซุงู `torch.float16` ุฃู `torch.bfloat16`).

ูู ูุนูุงุฑ ูุญูู (A100-40GBุ PyTorch 2.3.0ุ ูุธุงู ุงูุชุดุบูู Ubuntu 22.04) ูุน `float32` ููููุฐุฌ `facebook/vit-msn-base`ุ ุฑุฃููุง ุงูุชุญุณููุงุช ุงูุชุงููุฉ ุฃุซูุงุก ุงูุงุณุชุฏูุงู.

| ุญุฌู ุงูุฏูุนุฉ | ูุชูุณุท ููุช ุงูุงุณุชุฏูุงู (ูููู ุซุงููุฉ)ุ ูุถุน Eager | ูุชูุณุท ููุช ุงูุงุณุชุฏูุงู (ูููู ุซุงููุฉ)ุ ูููุฐุฌ SDPA | ุชุณุฑูุนุ SDPA / Eager (x) |
|--------------|-------------------------------------------|-------------------------------------------|------------------------------|
| 1 | 7 | 6 | 1.17 |
| 2 | 8 | 6 | 1.33 |
| 4 | 8 | 6 | 1.33 |
| 8 | 8 | 6 | 1.33 |

## ุงูููุงุฑุฏ

ูุงุฆูุฉ ุจููุงุฑุฏ Hugging Face ุงูุฑุณููุฉ ูููุงุฑุฏ ุงููุฌุชูุน (ุงููุดุงุฑ ุฅูููุง ุจู ๐) ููุณุงุนุฏุชู ูู ุงูุจุฏุก ูู ุงุณุชุฎุฏุงู ViT MSN.

<PipelineTag pipeline="image-classification"/>

- ูุฏุนูู [`ViTMSNForImageClassification`] ุจูุงุณุทุฉ [ูุต ุงูุจุฑูุงูุฌ ุงููุตู](https://github.com/huggingface/transformers/tree/main/examples/pytorch/image-classification) ู [ุฏูุชุฑ ุงูููุงุญุธุงุช](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/image_classification.ipynb) ูุฐุง.

- ุฑุงุฌุน ุฃูุถูุง: [ุฏููู ููุงู ุชุตููู ุงูุตูุฑ](../tasks/image_classification)

ุฅุฐุง ููุช ููุชููุง ุจุชูุฏูู ููุฑุฏ ูุฅุฏุฑุงุฌู ููุงุ ูุงูุฑุฌุงุก ูุชุญ ุทูุจ ุณุญุจ ูุณูุฑุงุฌุนู! ูุฌุจ ุฃู ููุถุญ ุงูููุฑุฏ ุจุดูู ูุซุงูู ุดูุฆูุง ุฌุฏูุฏูุง ุจุฏูุงู ูู ุชูุฑุงุฑ ููุฑุฏ ููุฌูุฏ.

## ViTMSNConfig

[[autodoc]] ViTMSNConfig

## ViTMSNModel

[[autodoc]] ViTMSNModel

- forward

## ViTMSNForImageClassification

[[autodoc]] ViTMSNForImageClassification

- forward