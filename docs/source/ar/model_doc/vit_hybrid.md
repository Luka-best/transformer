# Hybrid Vision Transformer (ViT Hybrid)

<Tip warning={true}>
ุชู ูุถุน ูุฐุง ุงููููุฐุฌ ูู ูุถุน ุงูุตูุงูุฉ ููุทุ ููู ููุจู ุฃู ุทูุจุงุช ุณุญุจ (PRs) ุฌุฏูุฏุฉ ูุชุบููุฑ ุดูุฑุชู. ุฅุฐุง ูุงุฌูุชู ุฃู ูุดููุงุช ุฃุซูุงุก ุชุดุบูู ูุฐุง ุงููููุฐุฌุ ูุฑุฌู ุฅุนุงุฏุฉ ุชุซุจูุช ุงูุฅุตุฏุงุฑ ุงูุฃุฎูุฑ ุงูุฐู ูุฏุนู ูุฐุง ุงููููุฐุฌ: v4.40.2. ููููู ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู: `pip install -U transformers==4.40.2`.
</Tip>

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุงูุชุฑุงุญ ูููุฐุฌ Hybrid Vision Transformer (ViT) ูู ุงููุฑูุฉ ุงูุจุญุซูุฉ [An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale](https://arxiv.org/abs/2010.11929) ุจูุงุณุทุฉ Alexey Dosovitskiy ู Lucas Beyer ู Alexander Kolesnikov ู Dirk Weissenborn ู Xiaohua Zhai ู Thomas Unterthiner ู Mostafa Dehghani ู Matthias Minderer ู Georg Heigold ู Sylvain Gelly ู Jakob Uszkoreit ู Neil Houlsby. ููู ุฃูู ูุฑูุฉ ุจุญุซูุฉ ุชููู ุจุชุฏุฑูุจ ูุญูู Transformer encoder ุจูุฌุงุญ ุนูู ImageNetุ ูุญููุช ูุชุงุฆุฌ ุฌูุฏุฉ ุฌุฏูุง ููุงุฑูุฉ ุจุงูุชุตูููุงุช ุงููุนูุงุฑูุฉ ุงูุถูููุฉ. ูุนุฏ ViT hybrid ูุชุบูุฑูุง ุจุณูุทูุง ูู [ูุญูู ุงูุฑุคูุฉ ุงูุนุงุฏู](vit)ุ ูุฐูู ูู ุฎูุงู ุงูุงุณุชูุงุฏุฉ ูู ุงูุนููุฏ ุงูููุฑู ููุดุจูุฉ ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ (Convolutional Neural Network) (ุจุดูู ูุญุฏุฏุ [BiT](bit)) ูุงูุชู ูุชู ุงุณุชุฎุฏุงู ููุฒุงุชูุง ูู "ุฑููุฒ" ุฃูููุฉ ููุญูู Transformer.

ููุฏูุฉ ุงููุฑูุฉ ุงูุจุญุซูุฉ ูู ููุง ููู:

*ุจูููุง ุฃุตุจุญุช ุจููุฉ Transformer ุงููุนูุงุฑูุฉ ูู ุงููุนูุงุฑ ุงููุนูู ูููุงู ูุนุงูุฌุฉ ุงููุบุฉ ุงูุทุจูุนูุฉุ ุฅูุง ุฃู ุชุทุจููุงุชูุง ูู ุฑุคูุฉ ุงูููุจููุชุฑ ูุง ุชุฒุงู ูุญุฏูุฏุฉ. ูู ุงูุฑุคูุฉุ ูุชู ุชุทุจูู ุงูุงูุชุจุงู ุฅูุง ุจุงูุงูุชุฑุงู ูุน ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉุ ุฃู ุงุณุชุฎุฏุงููุง ูุงุณุชุจุฏุงู ููููุงุช ูุนููุฉ ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ูุน ุงูุญูุงุธ ุนูู ูููููุง ุงูุนุงู ูู ููุงูู. ูุญู ููุถุญ ุฃู ูุฐุง ุงูุงุนุชูุงุฏ ุนูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ููุณ ุถุฑูุฑููุง ูุฃู ูุญูููุง ููููุง ูุชู ุชุทุจููู ูุจุงุดุฑุฉู ุนูู ุชุณูุณูุงุช ูู ุฑูุน ุงูุตูุฑ ูููู ุฃู ูุนูู ุจุดูู ุฌูุฏ ุฌุฏูุง ูู ููุงู ุชุตููู ุงูุตูุฑ. ุนูุฏูุง ูุชู ุชุฏุฑูุจ ูุญูู ุงูุฑุคูุฉ (ViT) ูุณุจููุง ุนูู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ูููููุง ุฅูู ุงูุนุฏูุฏ ูู ูุนุงููุฑ ุงูุชุนุฑู ุนูู ุงูุตูุฑ ูุชูุณุทุฉ ุงูุญุฌู ุฃู ุตุบูุฑุฉ ุงูุญุฌู (ImageNet ู CIFAR-100 ู VTABุ ููุง ุฅูู ุฐูู)ุ ูุฅูู ูุญูู ูุชุงุฆุฌ ููุชุงุฒุฉ ููุงุฑูุฉ ุจุดุจูุงุช ุงูุชูููู ุงูุงูุชูุงููุฉ ุงููุชูุฏูุฉ ุจูููุง ูุชุทูุจ ููุงุฑุฏ ุญุณุงุจูุฉ ุฃูู ุจูุซูุฑ ููุชุฏุฑูุจ.*

ุชูุช ุงููุณุงููุฉ ุจูุฐุง ุงููููุฐุฌ ูู ูุจู [nielsr](https://huggingface.co/nielsr). ูููู ุงูุนุซูุฑ ุนูู ุงูุดูุฑุฉ ุงูุฃุตููุฉ (ุงูููุชูุจุฉ ูู JAX) [ููุง](https://github.com/google-research/vision_transformer).

## ุงุณุชุฎุฏุงู Scaled Dot Product Attention (SDPA)

ุชุชุถูู PyTorch ูุดุบู ุงูุงูุชุจุงู ุงูููุชุดุฑ ุงูููุชุฌ ุงูููุทู ุงููููุงุณ ูุฌุฒุก ูู `torch.nn.functional`. ุชุดูู ูุฐู ุงูุฏุงูุฉ ุนุฏุฉ ุชูููุฐุงุช ูููู ุชุทุจูููุง ุงุนุชูุงุฏูุง ุนูู ุงููุฏุฎูุงุช ูุฃุฌูุฒุฉ ุงูุฃุฌูุฒุฉ ุงููุณุชุฎุฏูุฉ. ุฑุงุฌุน [ุงููุซุงุฆู ุงูุฑุณููุฉ](https://pytorch.org/docs/stable/generated/torch.nn.functional.scaled_dot_product_attention.html) ุฃู ุตูุญุฉ [GPU Inference](https://huggingface.co/docs/transformers/main/en/perf_infer_gpu_one#pytorch-scaled-dot-product-attention) ููุฒูุฏ ูู ุงููุนูููุงุช.

ูุชู ุงุณุชุฎุฏุงู SDPA ุจุดูู ุงูุชุฑุงุถู ูู `torch>=2.1.1` ุนูุฏูุง ูููู ุงูุชูููุฐ ูุชุงุญูุงุ ูููู ููููู ุฃูุถูุง ุชุนููู `attn_implementation="sdpa"` ูู `from_pretrained()` ูุทูุจ ุงุณุชุฎุฏุงู SDPA ุจุดูู ุตุฑูุญ.

```
from transformers import ViTHybridForImageClassification
model = ViTHybridForImageClassification.from_pretrained("google/vit-hybrid-base-bit-384", attn_implementation="sdpa", torch_dtype=torch.float16)
...
```

ููุญุตูู ุนูู ุฃูุถู ุงูุชุญุณููุงุช ูู ุงูุณุฑุนุฉุ ููุตู ุจุชุญููู ุงููููุฐุฌ ุจูุตู ุงูุฏูุฉ (ุนูู ุณุจูู ุงููุซุงู `torch.float16` ุฃู `torch.bfloat16`).

ุนูู ูุนูุงุฑ ููุงุณ ูุญูู (A100-40GBุ PyTorch 2.3.0ุ ูุธุงู ุงูุชุดุบูู Ubuntu 22.04) ูุน `float32` ููููุฐุฌ `google/vit-hybrid-base-bit-384`ุ ุฑุฃููุง ุงูุชุญุณููุงุช ูู ุงูุณุฑุนุฉ ุงูุชุงููุฉ ุฃุซูุงุก ุงูุงุณุชูุชุงุฌ.

| ุญุฌู ุงูุฏูุนุฉ | ูุชูุณุท ููุช ุงูุงุณุชูุชุงุฌ (ูููู ุซุงููุฉ)ุ ูุถุน Eager | ูุชูุณุท ููุช ุงูุงุณุชูุชุงุฌ (ูููู ุซุงููุฉ)ุ ูููุฐุฌ SDPA | ุชุณุฑูุนุ SDPA / Eager (x) |
|--------------|-------------------------------------------|-------------------------------------------|------------------------------|
| 1 | 29 | 18 | 1.61 |
| 2 | 26 | 18 | 1.44 |
| 4 | 25 | 18 | 1.39 |
| 8 | 34 | 24 | 1.42 |

## ุงูููุงุฑุฏ

ูููุง ููู ูุงุฆูุฉ ุจููุงุฑุฏ Hugging Face ุงูุฑุณููุฉ ูููุงุฑุฏ ุงููุฌุชูุน (ุงููุดุงุฑ ุฅูููุง ุจู ๐) ููุณุงุนุฏุชู ูู ุงูุจุฏุก ุจุงุณุชุฎุฏุงู ViT Hybrid.

<PipelineTag pipeline="image-classification"/>

- [`ViTHybridForImageClassification`] ูุฏุนูู ุจูุงุณุทุฉ [ูุต ุจุฑูุฌู ุชูุถูุญู](https://github.com/huggingface/transformers/tree/main/examples/pytorch/image-classification) ู [ุฏูุชุฑ ููุงุญุธุงุช](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/image_classification.ipynb).
- ุฑุงุฌุน ุฃูุถูุง: [ุฏููู ููุงู ุชุตููู ุงูุตูุฑ](../tasks/image_classification)

ุฅุฐุง ููุช ููุชููุง ุจุชูุฏูู ููุฑุฏ ูุฅุฏุฑุงุฌู ููุงุ ููุฑุฌู ูุชุญ ุทูุจ ุณุญุจ (Pull Request) ูุณูููู ุจูุฑุงุฌุนุชู! ูุฌุจ ุฃู ููุถุญ ุงูููุฑุฏ ุจุดูู ูุซุงูู ุดูุก ุฌุฏูุฏ ุจุฏูุงู ูู ุชูุฑุงุฑ ููุฑุฏ ููุฌูุฏ.

## ViTHybridConfig

[[autodoc]] ViTHybridConfig

## ViTHybridImageProcessor

[[autodoc]] ViTHybridImageProcessor

- preprocess

## ViTHybridModel

[[autodoc]] ViTHybridModel

- forward

## ViTHybridForImageClassification

[[autodoc]] ViTHybridForImageClassification

- forward