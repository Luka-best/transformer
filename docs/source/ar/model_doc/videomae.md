# VideoMAE

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุงูุชุฑุงุญ ูููุฐุฌ VideoMAE ูู [VideoMAE: Masked Autoencoders are Data-Efficient Learners for Self-Supervised Video Pre-Training](https://arxiv.org/abs/2203.12602) ุจูุงุณุทุฉ Zhan Tong ูYibing Song ูJue Wang ูLimin Wang.

ููุณุน VideoMAE ูุดูุฑุงุช ุงูุณูุงุฑุงุช ุงููููุนุฉ (MAE) ุฅูู ุงูููุฏููุ ูุฏุนููุง ุฃุฏุงุกู ูุชููุฒูุง ูู ุงูุนุฏูุฏ ูู ูุนุงููุฑ ุชุตููู ุงูููุฏูู.

ููุฎุต ุงููุฑูุฉ ูู ููุง ููู:

*ููุนุฏ ุชุฏุฑูุจ ุงููุญููุงุช ุงูููุฏูู ุงููุณุจู ุนูู ูุฌููุนุงุช ุจูุงูุงุช ูุจูุฑุฉ ููุบุงูุฉ ุฃูุฑูุง ูุทููุจูุง ุจุดูู ุนุงู ูุชุญููู ุฃุฏุงุก ูุชููุฒ ุนูู ูุฌููุนุงุช ุงูุจูุงูุงุช ุงูุตุบูุฑุฉ ูุณุจููุง. ูู ูุฐู ุงููุฑูุฉุ ููุธูุฑ ุฃู ูุดูุฑุงุช ุงูููุฏูู ุงููููุนุฉ (VideoMAE) ูู ูุชุนููุงุช ูุนุงูุฉ ููุจูุงูุงุช ููุชูุซูู ุงููุณุจู ููููุฏูู ุฐุงุชู ุงูุฅุดุฑุงู (SSVP). ูุณุชููู ูู ImageMAE ุงูุฐู ุชู ุทุฑุญู ูุคุฎุฑูุง ูููุชุฑุญ ุชุตูููุงุช ูุฎุตุตุฉ ูุฅุฎูุงุก ุฃูุจูุจ ุงูููุฏูู ูุฅุนุงุฏุฉ ุจูุงุฆู. ุงุชุถุญ ุฃู ูุฐู ุงูุชุตูููุงุช ุงูุจุณูุทุฉ ูุนุงูุฉ ูู ุงูุชุบูุจ ุนูู ุชุณุฑุจ ุงููุนูููุงุช ุงููุงุฌู ุนู ุงูุงุฑุชุจุงุท ุงูุฒููู ุฃุซูุงุก ุฅุนุงุฏุฉ ุจูุงุก ุงูููุฏูู. ุชูุตููุง ุฅูู ุซูุงุซุฉ ูุชุงุฆุฌ ูููุฉ ุญูู SSVP: (1) ูุง ูุฒุงู ูุนุฏู ุงูุฅุฎูุงุก ุงููุฑุชูุน ููุบุงูุฉ (ุฃู 90% ุฅูู 95%) ูุญูู ุฃุฏุงุกู ุฌูุฏูุง ููููุฐุฌ VideoMAE. ูุณูุญ ูุญุชูู ุงูููุฏูู ุงููุชูุฑุฑ ุฒููููุง ุจูุณุจุฉ ุฅุฎูุงุก ุฃุนูู ูู ุชูู ุงููุณุชุฎุฏูุฉ ูู ุงูุตูุฑ. (2) ูุญูู VideoMAE ูุชุงุฆุฌ ุฑุงุฆุนุฉ ูู ูุฌููุนุงุช ุจูุงูุงุช ุตุบูุฑุฉ ุฌุฏูุง (ุฃู ุญูุงูู 3000-4000 ููุฏูู) ุฏูู ุงุณุชุฎุฏุงู ุฃู ุจูุงูุงุช ุฅุถุงููุฉ. ููุฑุฌุน ุฐูู ุฌุฒุฆููุง ุฅูู ูููุฉ ุฅุนุงุฏุฉ ุจูุงุก ุงูููุฏูู ุงูุตุนุจุฉ ููุฑุถ ุชุนูู ุงูุจููุฉ ุนุงููุฉ ุงููุณุชูู. (3) ููุธูุฑ VideoMAE ุฃู ุฌูุฏุฉ ุงูุจูุงูุงุช ุฃูุซุฑ ุฃูููุฉ ูู ูููุฉ ุงูุจูุงูุงุช ูู SSVP. ูุนุฏ ุงูุชุญูู ูู ุงููุฌุงู ุจูู ูุฌููุนุงุช ุจูุงูุงุช ุงูุชุฏุฑูุจ ุงููุณุจู ูุงููุฌููุนุงุช ุงููุณุชูุฏูุฉ ูู ุงููุถุงูุง ุงููููุฉ ูู SSVP. ููู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃู ูููุฐุฌ VideoMAE ุงูุฎุงุต ุจูุง ูุน ุงูุนููุฏ ุงูููุฑู ViT ุงูุฃุณุงุณู ูููู ุฃู ูุญูู 83.9% ุนูู Kinects-400 ู75.3% ุนูู Something-Something V2 ู90.8% ุนูู UCF101 ู61.1% ุนูู HMDB51 ุฏูู ุงุณุชุฎุฏุงู ุฃู ุจูุงูุงุช ุฅุถุงููุฉ.*

<img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/transformers/model_doc/videomae_architecture.jpeg"
alt="drawing" width="600"/>

<small>ุงูุชุฏุฑูุจ ุงููุณุจู ูู VideoMAE. ูุฃุฎูุฐุฉ ูู <a href="https://arxiv.org/abs/2203.12602">ุงููุฑูุฉ ุงูุฃุตููุฉ</a>.</small>

ุชูุช ุงููุณุงููุฉ ุจูุฐุง ุงููููุฐุฌ ุจูุงุณุทุฉ [nielsr](https://huggingface.co/nielsr).
ูููู ุงูุนุซูุฑ ุนูู ุงูููุฏ ุงูุฃุตูู [ููุง](https://github.com/MCG-NJU/VideoMAE).

## ุงุณุชุฎุฏุงู Scaled Dot Product Attention (SDPA)
ุชุชุถูู PyTorch ูุดุบู ุงูุชูุงู ุงูููุชุฌ ุงูููุทู ุงููููุฒ (SDPA) ุงูุฃุตูู ูุฌุฒุก ูู `torch.nn.functional`. ุชุดูู ูุฐู ุงููุธููุฉ ุนุฏุฉ ุชุทุจููุงุช ูููู ุชุทุจูููุง ุงุนุชูุงุฏูุง ุนูู ุงููุฏุฎูุงุช ูุงูุฃุฌูุฒุฉ ุงููุณุชุฎุฏูุฉ. ุฑุงุฌุน [ุงููุซุงุฆู ุงูุฑุณููุฉ](https://pytorch.org/docs/stable/generated/torch.nn.functional.scaled_dot_product_attention.html)
ุฃู ุตูุญุฉ [GPU Inference](https://huggingface.co/docs/transformers/main/en/perf_infer_gpu_one#pytorch-scaled-dot-product-attention)
ููุฒูุฏ ูู ุงููุนูููุงุช.

ูุชู ุงุณุชุฎุฏุงู SDPA ุจุดูู ุงูุชุฑุงุถู ูู `torch>=2.1.1` ุนูุฏ ุชููุฑ ุงูุชุทุจููุ ูููู ููููู ุฃูุถูุง ุชุนููู
`attn_implementation="sdpa"` ูู `from_pretrained()` ูุทูุจ ุงุณุชุฎุฏุงู SDPA ุจุดูู ุตุฑูุญ.

```py
from transformers import VideoMAEForVideoClassification
model = VideoMAEForVideoClassification.from_pretrained("MCG-NJU/videomae-base-finetuned-kinetics", attn_implementation="sdpa", torch_dtype=torch.float16)
...
```

ููุญุตูู ุนูู ุฃูุถู ุงูุชุญุณููุงุชุ ููุตู ุจุชุญููู ุงููููุฐุฌ ุจูุตู ุงูุฏูุฉ (ุนูู ุณุจูู ุงููุซุงู `torch.float16` ุฃู `torch.bfloat16`).

ุนูู ูุนูุงุฑ ูุญูู (A100-40GBุ PyTorch 2.3.0ุ ูุธุงู ุงูุชุดุบูู Ubuntu 22.04) ูุน `float32` ููููุฐุฌ `MCG-NJU/videomae-base-finetuned-kinetics`ุ ุฑุฃููุง ุงูุชุญุณููุงุช ุงูุชุงููุฉ ุฃุซูุงุก ุงูุงุณุชุฏูุงู.

| ุญุฌู ุงูุฏูุนุฉ | ูุชูุณุท ููุช ุงูุงุณุชุฏูุงู (ูููู ุซุงููุฉ)ุ ูุถุน Eager | ูุชูุณุท ููุช ุงูุงุณุชุฏูุงู (ูููู ุซุงููุฉ)ุ ูููุฐุฌ SDPA | ุชุณุฑูุนุ SDPA / Eager (x) |
|--------------|-------------------------------------------|-------------------------------------------|------------------------------|
| 1 | 37 | 10 | 3.7 |
| 2 | 24 | 18 | 1.33 |
| 4 | 43 | 32 | 1.34 |
| 8 | 84 | 60 | 1.4 |

## ุงูููุงุฑุฏ
ูููุง ููู ูุงุฆูุฉ ุจููุงุฑุฏ Hugging Face ุงูุฑุณููุฉ ูููุงุฑุฏ ุงููุฌุชูุน (ูุดุงุฑ ุฅูููุง ุจู ๐) ููุณุงุนุฏุชู ูู ุงูุจุฏุก ุจุงุณุชุฎุฏุงู VideoMAE. ุฅุฐุง
ููุช ููุชููุง ุจุชูุฏูู ููุฑุฏ ูุฅุฏุฑุงุฌู ููุงุ ูุงูุฑุฌุงุก ูุชุญ ุทูุจ ุณุญุจ Pull Request ูุณูุฑุงุฌุนู! ูุฌุจ ุฃู ููุธูุฑ ุงูููุฑุฏ ุจุดูู ูุซุงูู ุดูุฆูุง ุฌุฏูุฏูุง ุจุฏูุงู ูู ุชูุฑุงุฑ ููุฑุฏ ููุฌูุฏ.

**ุชุตููู ุงูููุฏูู**
- [ุฏูุชุฑ ููุงุญุธุงุช](https://github.com/huggingface/notebooks/blob/main/examples/video_classification.ipynb) ููุธูุฑ ููููุฉ
ุถุจุท ูููุฐุฌ VideoMAE ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ.
- [ุฏููู ูููุฉ ุชุตููู ุงูููุฏูู](../tasks/video_classification)
- [ูุณุงุญุฉ ๐ค](https://huggingface.co/spaces/sayakpaul/video-classification-ucf101-subset) ุชูุธูุฑ ููููุฉ ุฅุฌุฑุงุก ุงูุงุณุชุฏูุงู ุจุงุณุชุฎุฏุงู ูููุฐุฌ ุชุตููู ุงูููุฏูู.

## VideoMAEConfig
[[autodoc]] VideoMAEConfig

## VideoMAEFeatureExtractor

[[autodoc]] VideoMAEFeatureExtractor
- __call__

## VideoMAEImageProcessor

[[autodoc]] VideoMAEImageProcessor
- preprocess

## VideoMAEModel

[[autodoc]] VideoMAEModel
- forward

## VideoMAEForPreTraining

ูุชุถูู `VideoMAEForPreTraining` ูู ุงูุชุดููุฑ ูู ุงูุฃุนูู ููุชุฏุฑูุจ ุงููุณุจู ุฐุงุชู ุงูุฅุดุฑุงู.

[[autodoc]] transformers.VideoMAEForPreTraining
- forward

## VideoMAEForVideoClassification

[[autodoc]] transformers.VideoMAEForVideoClassification
- forward