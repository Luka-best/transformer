# SegFormer

## ูุธุฑุฉ ุนุงูุฉ

ุงูุชุฑุญ ูููุฐุฌ SegFormer ูู ูุฑูุฉ "SegFormer: Simple and Efficient Design for Semantic Segmentation with Transformers" ุจูุงุณุทุฉ Enze Xie ูุขุฎุฑูู. ูุชููู ุงููููุฐุฌ ูู ุชุฑููุฒ Transformer ูุฑูู ูุฑุฃุณ ูู ุชุดููุฑ ุฎููู ุงููุฒู ูุนุชูุฏ ุจุงููุงูู ุนูู MLP ูุชุญููู ูุชุงุฆุฌ ููุชุงุฒุฉ ูู ูุนุงููุฑ ุชุตููู ุงูุตูุฑ ูุซู ADE20K ูCityscapes.

ุงูููุฎุต ูู ุงููุฑูุฉ ูู ูุง ููู:

> "ููุฏู SegFormerุ ููู ุฅุทุงุฑ ุนูู ูุชุตููู ุงูุตูุฑ ุงูุจุณูุท ูุงููุนุงู ูุงูููู ุงูุฐู ููุญุฏ ุงููุญููุงุช ูุน ูู ุชุฑููุฒ ุงูุฅุฏุฑุงู ูุชุนุฏุฏ ุงูุทุจูุงุช (MLP) ุฎููู ุงููุฒู. ูุชููุฒ SegFormer ุจููุฒุชูู ุฌุฐุงุจุชูู: 1) ูุชููู SegFormer ูู ุชุฑููุฒ ูุญูู ูุฑูู ููููู ุฌุฏูุฏ ููุชุฌ ููุฒุงุช ูุชุนุฏุฏุฉ ุงูููุงููุณ. ูุง ูุญุชุงุฌ ุฅูู ุชุฑููุฒ ุงูููุถุนุ ูุจุงูุชุงูู ูุชุฌูุจ ุงูุงุณุชููุงุก ูุฑููุฒ ุงูููุถุนูุฉ ุงูุชู ุชุคุฏู ุฅูู ุงูุฎูุงุถ ุงูุฃุฏุงุก ุนูุฏูุง ูุฎุชูู ุงููุฑุงุฑ ุนูุฏ ุงูุงุฎุชุจุงุฑ ุนู ุงูุชุฏุฑูุจ. 2) ูุชุฌูุจ SegFormer ูู ุงูุชุฑููุฒ ุงููุนูุฏ. ูููู ูู ุชุฑููุฒ MLP ุงูููุชุฑุญ ุจุชุฌููุน ุงููุนูููุงุช ูู ุทุจูุงุช ูุฎุชููุฉุ ูุจุงูุชุงูู ุงูุฌูุน ุจูู ูู ูู ุงูุงูุชูุงู ุงููุญูู ูุงูุนุงููู ูุชุตููุฑ ุชูุซููุงุช ูููุฉ. ููุธูุฑ ุฃู ูุฐุง ุงูุชุตููู ุงูุจุณูุท ูุงูุฎููู ูู ุงูููุชุงุญ ูุชุตููู ุงูููุงุกุฉ ุนูู ุงููุญููุงุช. ูููู ุจุฒูุงุฏุฉ ูููุงุณ ููุฌูุง ููุญุตูู ุนูู ุณูุณูุฉ ูู ุงูููุงุฐุฌ ูู SegFormer-B0 ุฅูู SegFormer-B5ุ ููุง ูุญูู ุฃุฏุงุกู ูููุงุกุฉ ุฃูุถู ุจูุซูุฑ ูู ุงููุธุงุฆุฑ ุงูุณุงุจูุฉ. ุนูู ุณุจูู ุงููุซุงูุ ูุญูู SegFormer-B4 ูุณุจุฉ 50.3% mIoU ุนูู ADE20K ูุน 64 ููููู ูุนุงููุ ููู ุฃุตุบุฑ 5 ูุฑุงุช ูุฃูุถู ุจูุณุจุฉ 2.2% ูู ุงูุทุฑููุฉ ุงูุฃูุถู ุงูุณุงุจูุฉ. ููุญูู ูููุฐุฌูุง ุงูุฃูุถูุ SegFormer-B5ุ ูุณุจุฉ 84.0% mIoU ุนูู ูุฌููุนุฉ ุงูุชุญูู ูู Cityscapes ููุธูุฑ ูุชุงูุฉ ููุชุงุฒุฉ ููุชุตููู ุงูุตูุฑู ุนูู Cityscapes-C."

ููุถุญ ุงูุดูู ุฃุฏูุงู ุจููุฉ SegFormer. ูุฃุฎูุฐุฉ ูู ุงููุฑูุฉ ุงูุฃุตููุฉ.

![ุจููุฉ SegFormer](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/segformer_architecture.png)

ุชูุช ุงููุณุงููุฉ ุจูุฐุง ุงููููุฐุฌ ุจูุงุณุทุฉ [nielsr](https://huggingface.co/nielsr). ุชูุช ุงููุณุงููุฉ ูู ุฅุตุฏุงุฑ TensorFlow ูู ุงููููุฐุฌ ุจูุงุณุทุฉ [sayakpaul](https://huggingface.co/sayakpaul). ูููู ุงูุนุซูุฑ ุนูู ุงูููุฏ ุงูุฃุตูู [ููุง](https://github.com/NVlabs/SegFormer).

## ูุตุงุฆุญ ุงูุงุณุชุฎุฏุงู

- ูุชููู SegFormer ูู ุชุฑููุฒ ูุญูู ูุฑูู ูุฑุฃุณ ูู ุชุดููุฑ ุฎููู ุงููุฒู ูุนุชูุฏ ุจุงููุงูู ุนูู MLP. [`SegformerModel`] ูู ุชุฑููุฒ ุงููุญูู ุงููุฑูู (ุงูุฐู ูุดุงุฑ ุฅููู ุฃูุถูุง ูู ุงููุฑูุฉ ุจุงุณู Mix Transformer ุฃู MiT). ูุถูู [`SegformerForSemanticSegmentation`] ุฑุฃุณ ูู ุชุดููุฑ MLP ุจุงููุงูู ูุฃุฏุงุก ุงูุชุตููู ุงูุฏูุงูู ููุตูุฑ. ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ููุงู [`SegformerForImageClassification`] ุงูุฐู ูููู ุงุณุชุฎุฏุงูู - ููุง ูู ูุชููุน - ูุชุตููู ุงูุตูุฑ. ูุงู ูุคููู SegFormer ุฃููุงู ุจุชุฏุฑูุจ ุงููุญูู ุงูุชุฑููุฒู ูุณุจููุง ุนูู ImageNet-1k ูุชุตููู ุงูุตูุฑ. ุจุนุฏ ุฐููุ ูููููู ุจุญุฐู ุฑุฃุณ ุงูุชุตูููุ ูุงุณุชุจุฏุงูู ุจุฑุฃุณ ูู ุชุดููุฑ MLP. ุจุนุฏ ุฐููุ ูููููู ุจุชุฏุฑูุจ ุงููููุฐุฌ ุจุงููุงูู ุนูู ADE20K ูCityscapes ูCOCO-stuffุ ูุงูุชู ุชุนุฏ ูุนุงููุฑ ูุฑุฌุนูุฉ ูููุฉ ูุชุตููู ุงูุตูุฑ. ูููู ุงูุนุซูุฑ ุนูู ุฌููุน ููุงุท ุงูุชูุชูุด ุนูู [ุงููุฑูุฒ](https://huggingface.co/models?other=segformer).

- ุฃุณุฑุน ุทุฑููุฉ ููุจุฏุก ูุน SegFormer ูู ุงูุชุญูู ูู [ุฏูุงุชุฑ ุงูููุงุญุธุงุช ุงูุชูุถูุญูุฉ](https://github.com/NielsRogge/Transformers-Tutorials/tree/master/SegFormer) (ุงูุชู ุชุนุฑุถ ูู ูู ุงูุงุณุชุฏูุงู ูุงูุชุฏุฑูุจ ุงูุฏููู ุนูู ุงูุจูุงูุงุช ุงููุฎุตุตุฉ). ูููู ูููุฑุก ุฃูุถูุง ุงูุงุทูุงุน ุนูู [ููุดูุฑ ุงููุฏููุฉ](https://huggingface.co/blog/fine-tune-segformer) ุงูุฐู ููุฏู SegFormer ูููุถุญ ููููุฉ ุถุจุทู ุจุฏูุฉ ุนูู ุจูุงูุงุช ูุฎุตุตุฉ.

- ูุฌุจ ุฃู ูุดูุฑ ูุณุชุฎุฏูู TensorFlow ุฅูู [ูุฐุง ุงููุณุชูุฏุน](https://github.com/deep-diver/segformer-tf-transformers) ุงูุฐู ููุถุญ ุงูุงุณุชุฏูุงู ูุงูุถุจุท ุงูุฏููู ุฎุงุฑุฌ ุงูุตูุฏูู.

- ูููู ูููุฑุก ุฃูุถูุง ุงูุงุทูุงุน ุนูู [ูุฐุง ุงูุนุฑุถ ุงูุชูุถูุญู ุงูุชูุงุนูู ุนูู Hugging Face Spaces](https://huggingface.co/spaces/chansung/segformer-tf-transformers) ูุชุฌุฑุจุฉ ูููุฐุฌ SegFormer ุนูู ุงูุตูุฑ ุงููุฎุตุตุฉ.

- ูุนูู SegFormer ูุน ุฃู ุญุฌู ุฅุฏุฎุงูุ ุญูุซ ูููู ุจุชูุณูู ุงูุฅุฏุฎุงู ููููู ูุงุจูุงู ูููุณูุฉ ุนูู `config.patch_sizes`.

- ูููู ูููุฑุก ุงุณุชุฎุฏุงู [`SegformerImageProcessor`] ูุฅุนุฏุงุฏ ุงูุตูุฑ ูุฎุฑุงุฆุท ุงูุชุฌุฒุฆุฉ ุงูููุงุจูุฉ ูููููุฐุฌ. ูุงุญุธ ุฃู ูุนุงูุฌ ุงูุตูุฑ ูุฐุง ุฃุณุงุณู ุฅูู ุญุฏ ูุง ููุง ูุชุถูู ุฌููุน ุนูููุงุช ุฒูุงุฏุฉ ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ ูู ุงููุฑูุฉ ุงูุฃุตููุฉ. ูููู ุงูุนุซูุฑ ุนูู ุฎุทูุท ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ุงูุฃุตููุฉ (ููุฌููุนุฉ ุจูุงูุงุช ADE20k ุนูู ุณุจูู ุงููุซุงู) [ููุง](https://github.com/NVlabs/SegFormer/blob/master/local_configs/_base_/datasets/ade20k_repeat.py). ุชุชูุซู ุฃูู ุฎุทูุฉ ูููุนุงูุฌุฉ ุงููุณุจูุฉ ูู ุงูุชุตุงุต ุงูุตูุฑ ูุฎุฑุงุฆุท ุงูุชุฌุฒุฆุฉ ุนุดูุงุฆููุง ูุฅุถุงูุชูุง ุฅูู ููุณ ุงูุญุฌูุ ูุซู 512x512 ุฃู 640x640ุ ุซู ูุชู ุชุทุจูุนูุง.

- ููุงู ุดูุก ุฅุถุงูู ูุฌุจ ูุฑุงุนุงุชู ููู ุฃูู ูููู ุชููุฆุฉ [`SegformerImageProcessor`] ุจุงุณุชุฎุฏุงู `do_reduce_labels` ุนูู `True` ุฃู `False`. ูู ุจุนุถ ูุฌููุนุงุช ุงูุจูุงูุงุช (ูุซู ADE20k)ุ ูุชู ุงุณุชุฎุฏุงู ุงูููุฑุณ 0 ูู ุฎุฑุงุฆุท ุงูุชุฌุฒุฆุฉ ุงููุดุฑูุญุฉ ููุฎูููุฉ. ููุน ุฐููุ ูุง ุชุชุถูู ูุฌููุนุฉ ุจูุงูุงุช ADE20k ูุฆุฉ "ุงูุฎูููุฉ" ูู ุนูุงูุงุชูุง ุงูุจุงูุบ ุนุฏุฏูุง 150. ูุฐููุ ูุชู ุงุณุชุฎุฏุงู `do_reduce_labels` ูุฎูุถ ุฌููุน ุงูุนูุงูุงุช ุจููุฏุงุฑ 1ุ ูุงูุชุฃูุฏ ูู ุนุฏู ุญุณุงุจ ุฃู ุฎุณุงุฑุฉ ููุฆุฉ "ุงูุฎูููุฉ" (ุฃู ุฃููุง ุชุณุชุจุฏู 0 ูู ุงูุฎุฑุงุฆุท ุงููุดุฑูุญุฉ ุจู 255ุ ููู *ignore_index* ูุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุงููุณุชุฎุฏูุฉ ุจูุงุณุทุฉ [`SegformerForSemanticSegmentation`]). ููุน ุฐููุ ุชุณุชุฎุฏู ูุฌููุนุงุช ุจูุงูุงุช ุฃุฎุฑู ุงูููุฑุณ 0 ููุฆุฉ ุฎูููุฉ ูุชุชุถูู ูุฐู ุงููุฆุฉ ูุฌุฒุก ูู ุฌููุน ุงูุนูุงูุงุช. ูู ูุฐู ุงูุญุงูุฉุ ูุฌุจ ุชุนููู `do_reduce_labels` ุนูู `False`ุ ุญูุซ ูุฌุจ ุฃูุถูุง ุญุณุงุจ ุงูุฎุณุงุฑุฉ ููุฆุฉ ุงูุฎูููุฉ.

- ูุซู ูุนุธู ุงูููุงุฐุฌุ ูุฃุชู SegFormer ุจุฃุญุฌุงู ูุฎุชููุฉุ ูููู ุงูุนุซูุฑ ุนูู ุชูุงุตูููุง ูู ุงูุฌุฏูู ุฃุฏูุงู (ูุฃุฎูุฐ ูู ุงูุฌุฏูู 7 ูู [ุงููุฑูุฉ ุงูุฃุตููุฉ](https://arxiv.org/abs/2105.15203)).

| **ูุชุบูุฑ ุงููููุฐุฌ** | **ุงูุฃุนูุงู**    | **ุฃุญุฌุงู ุงููุฎููุฉ**    | **ุญุฌู ูุฎูู ูู ุงูุชุฑููุฒ** | **ุงููุนููุงุช (ู)** | **ImageNet-1k Top 1** |
| :---------------: | ------------- | ------------------- | :---------------------: | :------------: | :-------------------: |
| MiT-b0            | [2ุ 2ุ 2ุ 2]  | [32ุ 64ุ 160ุ 256]  | 256                     | 3.7            | 70.5                  |
| MiT-b1            | [2ุ 2ุ 2ุ 2]  | [64ุ 128ุ 320ุ 512] | 256                     | 14.0           | 78.7                  |
| MiT-b2            | [3ุ 4ุ 6ุ 3]  | [64ุ 128ุ 320ุ 512] | 768                     | 25.4           | 81.6                  |
| MiT-b3            | [3ุ 4ุ 18ุ 3] | [64ุ 128ุ 320ุ 512] | 768                     | 45.2           | 83.1                  |
| MiT-b4            | [3ุ 8ุ 27ุ 3] | [64ุ 128ุ 320ุ 512] | 768                     | 62.6           | 83.6                  |
| MiT-b5            | [3ุ 6ุ 40ุ 3] | [64ุ 128ุ 320ุ 512] | 768                     | 82.0           | 83.8                  |

ูุงุญุธ ุฃู MiT ูู ุงูุฌุฏูู ุฃุนูุงู ูุดูุฑ ุฅูู ุงูุนููุฏ ุงูููุฑู ูุชุฑููุฒ ุงููุญูู ุงููุฎุชูุท ุงูููุฏู ูู SegFormer. ููุญุตูู ุนูู ูุชุงุฆุฌ SegFormer ุนูู ูุฌููุนุงุช ุจูุงูุงุช ุงูุชุฌุฒุฆุฉ ูุซู ADE20kุ ุฑุงุฌุน [ุงููุฑูุฉ](https://arxiv.org/abs/2105.15203).

## ุงูููุงุฑุฏ

ูุงุฆูุฉ ุจููุงุฑุฏ Hugging Face ุงูุฑุณููุฉ ูููุงุฑุฏ ุงููุฌุชูุน (ูุดุงุฑ ุฅูููุง ุจู ๐) ููุณุงุนุฏุชู ูู ุงูุจุฏุก ุจุงุณุชุฎุฏุงู SegFormer.

- [`SegformerForImageClassification`] ูุฏุนูู ุจูุงุณุทุฉ [ูุต ุงูุจุฑูุงูุฌ ุงููุตู ุงูุชูุถูุญู](https://github.com/huggingface/transformers/tree/main/examples/pytorch/image-classification) ู [ุฏูุชุฑ ุงูููุงุญุธุงุช](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/image_classification.ipynb).

- [ุฏููู ููุงู ุชุตููู ุงูุตูุฑ](../tasks/image_classification)

ุงูุชุตููู ุงูุฏูุงูู:

- [`SegformerForSemanticSegmentation`] ูุฏุนูู ุจูุงุณุทุฉ [ูุต ุงูุจุฑูุงูุฌ ุงููุตู ุงูุชูุถูุญู](https://github.com/huggingface/transformers/tree/main/examples/pytorch/semantic-segmentation).

- ูููู ุงูุนุซูุฑ ุนูู ูุฏููุฉ ุญูู ุงูุถุจุท ุงูุฏููู ูู SegFormer ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ [ููุง](https://huggingface.co/blog/fine-tune-segformer).

- ูููู ุงูุนุซูุฑ ุนูู ุงููุฒูุฏ ูู ุฏูุงุชุฑ ุงูููุงุญุธุงุช ุงูุชูุถูุญูุฉ ุญูู SegFormer (ุงูุงุณุชุฏูุงู + ุงูุถุจุท ุงูุฏููู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ) [ููุง](https://github.com/NielsRogge/Transformers-Tutorials/tree/master/SegFormer).

- [`TFSegformerForSemanticSegmentation`] ูุฏุนูู ุจูุงุณุทุฉ [ุฏูุชุฑ ุงูููุงุญุธุงุช ุงูุชูุถูุญู ูุฐุง](https://github.com/huggingface/notebooks/blob/main/examples/semantic_segmentation-tf.ipynb).

- [ุฏููู ููุงู ุงูุชุฌุฒุฆุฉ ุงูุฏูุงููุฉ](../tasks/semantic_segmentation)

ุฅุฐุง ููุช ููุชููุง ุจุชูุฏูู ููุฑุฏ ูุฅุฏุฑุงุฌู ููุงุ ูุงูุฑุฌุงุก ูุชุญ ุทูุจ ุณุญุจ ูุณูุฑุงุฌุนู! ูุฌุจ ุฃู ููุถุญ ุงูููุฑุฏ ูู ุงููุถุน ุงููุซุงูู ุดูุฆูุง ุฌุฏูุฏูุง ุจุฏูุงู ูู ุชูุฑุงุฑ ููุฑุฏ ููุฌูุฏ.

## SegformerConfig

[[autodoc]] SegformerConfig

## SegformerFeatureExtractor

[[autodoc]] SegformerFeatureExtractor

- __call__

- post_process_semantic_segmentation

## SegformerImageProcessor

[[autodoc]] SegformerImageProcessor

- preprocess

- post_process_semantic_segmentation

<frameworkcontent>
<pt>

## SegformerModel

[[autodoc]] SegformerModel

- forward

## SegformerDecodeHead

[[autodoc]] SegformerDecodeHead

- forward

## SegformerForImageClassification

[[autodoc]] SegformerForImageClassification

- forward

## SegformerForSemanticSegmentation

[[autodoc]] SegformerForSemanticSegmentation

- forward

</pt>
<tf>

## TFSegformerDecodeHead

[[autodoc]] TFSegformerDecodeHead

- call

## TFSegformerModel

[[autodoc]] TFSegformerModel

- call

## TFSegformerForImageClassification

[[autodoc]] TFSegformerForImageClassification

- call

## TFSegformerForSemanticSegmentation

[[autodoc]] TFSegformerForSemanticSegmentation

- call

</tf>
</frameworkcontent>