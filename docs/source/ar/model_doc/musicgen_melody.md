# MusicGen Melody  

## ูุธุฑุฉ ุนุงูุฉ  

ุงูุชุฑุญ ูููุฐุฌ MusicGen Melody ูู ูุฑูุฉ "Simple and Controllable Music Generation" ูู ูุจู ุฌูุฏ ููุจูุชุ ููููููุณ ูุฑููุ ูุฅูุชุงู ุฌุงุชุ ูุชุงู ุฑูููุฒุ ูุฏูููุฏ ูุงูุชุ ูุบุงุจุฑููู ุณููููุ ูููุณู ุนุฏูุ ูุฃููุณูุฏุฑ ุฏูููุณูู.  

MusicGen Melody ูู ูููุฐุฌ ุชุญูููู ุฃุญุงุฏู ุงููุฑุญูุฉ ูุนุชูุฏ ุนูู ุงูุชูููุฏ ุงูุฐุงุชูุ ููุงุฏุฑ ุนูู ุชูููุฏ ุนููุงุช ููุณูููุฉ ุนุงููุฉ ุงูุฌูุฏุฉ ุจูุงุกู ุนูู ุฃูุตุงู ูุตูุฉ ุฃู ุฅุดุงุฑุงุช ุตูุชูุฉ. ุชูุฑ ุงูุฃูุตุงู ุงููุตูุฉ ุนุจุฑ ูููุฐุฌ ูุดูุฑ ูุตู ูุฌูุฏ ููุญุตูู ุนูู ุชุณูุณู ูู ุงูุชูุซููุงุช ุงููุฎููุฉ. ุซู ูุชู ุชุฏุฑูุจ MusicGen ููุชูุจุค ุจุงูุฑููุฒ ุงูุตูุชูุฉ ุงููููุตูุฉุ ุฃู "ุฑููุฒ ุงูุตูุช"ุ ุงููุดุฑูุทุฉ ุจูุฐู ุงูุญุงูุงุช ุงููุฎููุฉ. ุจุนุฏ ุฐููุ ูุชู ูู ุชุดููุฑ ูุฐู ุงูุฑููุฒ ุงูุตูุชูุฉ ุจุงุณุชุฎุฏุงู ูููุฐุฌ ุถุบุท ุตูุชู ูุซู EnCodec ูุงุณุชุนุงุฏุฉ ุงูููุฌุฉ ุงูุตูุชูุฉ.  

ูู ุฎูุงู ููุท ุชุดุงุจู ุงูุฑููุฒ ุจููุงุกุฉุ ูุง ูุญุชุงุฌ MusicGen ุฅูู ุชูุซูู ุฏูุงูู ุฐุงุชู ุงูุฅุดุฑุงู ููุฅุดุงุฑุงุช ุงููุตูุฉ/ุงูุตูุชูุฉุ ููุง ููุบู ุงูุญุงุฌุฉ ุฅูู ุชุณูุณู ููุงุฐุฌ ูุชุนุฏุฏุฉ ููุชูุจุค ุจูุฌููุนุฉ ูู ูุชุจ ุงูุฑููุฒ (ุนูู ุณุจูู ุงููุซุงูุ ุชุณูุณูููุง ุฃู ุนู ุทุฑูู ุฒูุงุฏุฉ ุงูุนููุงุช). ุจุฏูุงู ูู ุฐููุ ููู ูุงุฏุฑ ุนูู ุชูููุฏ ุฌููุน ูุชุจ ุงูุฑููุฒ ูู ุนูููุฉ ุชูุฌูู ูุงุญุฏุฉ.  

ุงูููุฎุต ูู ุงููุฑูุฉ ูู ูุง ููู:  

*ูุญู ูุชูุงูู ูููุฉ ุชูููุฏ ุงูููุณููู ุงูุดุฑุทู. ููุฏู MusicGenุ ููู ูููุฐุฌ ูุบุฉ ูุงุญุฏ ูุนูู ุนูู ุนุฏุฉ ุชูุงุฑุงุช ูู ุงูุชูุซูู ุงูููุณููู ุงููููุตู ุงููุถุบูุทุ ุฃู ุงูุฑููุฒ. ุนูู ุนูุณ ุงูุนูู ุงูุณุงุจูุ ูุชููู MusicGen ูู ูููุฐุฌ ูุบุฉ ูุญูู ุฃุญุงุฏู ุงููุฑุญูุฉ ุฌูุจูุง ุฅูู ุฌูุจ ูุน ุฃููุงุท ุชุดุงุจู ุงูุฑููุฒ ุงููุนุงูุฉุ ูุงูุชู ุชููุบู ุงูุญุงุฌุฉ ุฅูู ุชุณูุณู ุนุฏุฉ ููุงุฐุฌุ ุนูู ุณุจูู ุงููุซุงูุ ุชุณูุณูููุง ุฃู ุนู ุทุฑูู ุฒูุงุฏุฉ ุงูุนููุงุช. ูู ุฎูุงู ูุฐุง ุงูููุฌุ ููุถุญ ููู ูููู ูู MusicGen ุชูููุฏ ุนููุงุช ุนุงููุฉ ุงูุฌูุฏุฉุ ูุน ุงูุดุฑุท ุนูู ุงููุตู ุงููุตู ุฃู ุงูููุฒุงุช ุงููุญููุฉุ ููุง ูุณูุญ ุจุถูุงุจุท ุฃูุถู ุนูู ุงูุฅุฎุฑุงุฌ ุงููููุฏ. ูุฌุฑู ุชูููููุง ุชุฌุฑูุจููุง ูุงุณุน ุงููุทุงูุ ูุน ูุฑุงุนุงุฉ ุงูุฏุฑุงุณุงุช ุงูุชููุงุฆูุฉ ูุงูุจุดุฑูุฉ ุนูู ุญุฏ ุณูุงุกุ ููุง ููุธูุฑ ุฃู ุงูููุฌ ุงูููุชุฑุญ ูุชููู ุนูู ุฎุทูุท ุงูุฃุณุงุณ ุงูููููุฉ ุนูู ูุนูุงุฑ ููุงุณู ูููุต ุฅูู ุงูููุณููู. ูู ุฎูุงู ุฏุฑุงุณุงุช ุงูุชุญููู ุงูุชูููุ ูุณูุท ุงูุถูุก ุนูู ุฃูููุฉ ูู ูููู ูู ุงูููููุงุช ุงูุชู ูุชููู ูููุง MusicGen.*  

ุชูุช ุงููุณุงููุฉ ุจูุฐุง ุงููููุฐุฌ ูู ูุจู [ylacombe](https://huggingface.co/ylacombe). ูููู ุงูุนุซูุฑ ุนูู ุงูููุฏ ุงูุฃุตูู [ููุง](https://github.com/facebookresearch/audiocraft). ูููู ุงูุนุซูุฑ ุนูู ููุงุท ุงูุชุญูู ุงููุณุจูุฉ ุงูุชุฏุฑูุจ ุนูู [Hugging Face Hub](https://huggingface.co/models?sort=downloads&search=facebook%2Fmusicgen).  

## ุงููุฑู ูุน [MusicGen](https://huggingface.co/docs/transformers/main/en/model_doc/musicgen)  

ููุงู ุงุฎุชูุงูุงู ุฑุฆูุณูุงู ูุน MusicGen:  
1. ูุชู ุงุณุชุฎุฏุงู ุงูุฅุดุงุฑุฉ ุงูุตูุชูุฉ ููุง ูุฅุดุงุฑุฉ ุดุฑุทูุฉ ููุนููุฉ ุงูุตูุชูุฉ ุงููููุฏุฉุ ุจูููุง ูุชู ุงุณุชุฎุฏุงููุง ูุงุณุชูุฑุงุฑ ุงูุตูุช ูู [MusicGen](https://huggingface.co/docs/transformers/main/en/model_doc/musicgen).  
2. ูุชู ุฏูุฌ ุงูุฅุดุงุฑุงุช ุงููุตูุฉ ูุงูุตูุชูุฉ ุงูุดุฑุทูุฉ ูุน ุญุงูุงุช ูู ุงูุชุดููุฑ ุงููุฎููุฉ ุจุฏูุงู ูู ุงุณุชุฎุฏุงููุง ูุฅุดุงุฑุฉ ุงูุชูุงู ูุชูุงุทุนุ ููุง ูู ุงูุญุงู ูู MusicGen.  

## ุงูุชูููุฏ  

MusicGen Melody ูุชูุงูู ูุน ูุถุนู ุงูุชูููุฏ: ุงูุฌุดุน ูุงูููุฐุฌุฉ. ูู ุงููุงุญูุฉ ุงูุนูููุฉุ ูุคุฏู ุงูููุฐุฌุฉ ุฅูู ูุชุงุฆุฌ ุฃูุถู ุจูุซูุฑ ูู ุงูุฌุดุนุ ูุฐูู ูุดุฌุน ุนูู ุงุณุชุฎุฏุงู ูุถุน ุงูููุฐุฌุฉ ุญูุซูุง ุฃููู ุฐูู. ูุชู ุชูููู ุงูููุฐุฌุฉ ุจุดูู ุงูุชุฑุงุถูุ ููููู ุชุญุฏูุฏูุง ุจุดูู ุตุฑูุญ ุนู ุทุฑูู ุชุนููู `do_sample=True` ูู ุงูููุงููุฉ ุฅูู [`MusicgenMelodyForConditionalGeneration.generate`]` `ุ ุฃู ุนู ุทุฑูู ุชุฌุงูุฒ ุชูููู ุงูุชูููุฏ ูููููุฐุฌ (ุงูุธุฑ ุฃุฏูุงู).  

ุชุฏุนู Transformers ููุง ุงูุฅุตุฏุงุฑูู ุฃุญุงุฏู ุงูููุงุฉ (1-channel) ู ุณุชูุฑูู (2-channel) ูู MusicGen Melody. ุชููู ุฅุตุฏุงุฑุงุช ุงูููุงุฉ ุฃุญุงุฏูุฉ ุงูููุงุฉ ุจุชูููุฏ ูุฌููุนุฉ ูุงุญุฏุฉ ูู ูุชุจ ุงูุฑููุฒ. ุชููู ุงูุฅุตุฏุงุฑุงุช ุงูุณุชูุฑูู ุจุชูููุฏ ูุฌููุนุชูู ูู ูุชุจ ุงูุฑููุฒุ ูุงุญุฏุฉ ููู ููุงุฉ (ูุณุงุฑ/ูููู)ุ ููุชู ูู ุชุดููุฑ ูู ูุฌููุนุฉ ูู ูุชุจ ุงูุฑููุฒ ุจุดูู ูุณุชูู ูู ุฎูุงู ูููุฐุฌ ุถุบุท ุงูุตูุช. ูุชู ุฏูุฌ ุชูุงุฑุงุช ุงูุตูุช ููู ููุงุฉ ูุฅุนุทุงุก ุงูุฅุฎุฑุงุฌ ุงูุณุชูุฑูู ุงูููุงุฆู.  

#### ุงูุชูููุฏ ุงูุดุฑุทู ุงูุตูุชู  

ูููู ูููููุฐุฌ ุชูููุฏ ุนููุฉ ุตูุชูุฉ ูุดุฑูุทุฉ ุจูุต ูุฅุดุงุฑุฉ ุตูุชูุฉ ุจุงุณุชุฎุฏุงู [`MusicgenMelodyProcessor`] ููุนุงูุฌุฉ ุงูุฅุฏุฎุงูุงุช.  

ูู ุงูุฃูุซูุฉ ุงูุชุงููุฉุ ูููู ุจุชุญููู ููู ุตูุชู ุจุงุณุชุฎุฏุงู ููุชุจุฉ Datasets ๐คุ ูุงูุชู ูููู ุชุซุจูุชูุง ุนุจุฑ ุงูุฃูุฑ ุฃุฏูุงู:  

```
pip install --upgrade pip
pip install datasets[audio]
```  

ูุชู ุชุญููู ููู ุงูุตูุช ุงูุฐู ุณูุณุชุฎุฏูู ุนูู ุงููุญู ุงูุชุงูู:  

```python
>>> from datasets import load_dataset

>>> dataset = load_dataset("sanchit-gandhi/gtzan", split="train", streaming=True)
>>> sample = next(iter(dataset))["audio"]
```  

ูู ุงููุงุญูุฉ ุงููุซุงููุฉุ ูุฌุจ ุฃู ุชููู ุงูุฅุดุงุฑุฉ ุงูุตูุชูุฉ ุฎุงููุฉ ูู ุงูุฅุดุงุฑุงุช ุฐุงุช ุงูุชุฑุฏุฏ ุงูููุฎูุถ ุงูุชู ุชูุชุฌูุง ุนุงุฏุฉู ุขูุงุช ูุซู ุงูุทุจูู ูุงูุบูุชุงุฑ ุงูุจุงุต. ูููู ุงุณุชุฎุฏุงู ูููุฐุฌ [Demucs](https://github.com/adefossez/demucs/tree/main) ููุตู ุงูุฃุตูุงุช ูุงูุถูุถุงุก ุงูุฃุฎุฑู ุนู ููููุงุช ุงูุทุจูู ูุงูุบูุชุงุฑ ุงูุจุงุต.  

ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงุณุชุฎุฏุงู Demucsุ ููุฌุจ ุนููู ุฃููุงู ุงุชุจุงุน ุฎุทูุงุช ุงูุชุซุจูุช [ููุง](https://github.com/adefossez/demucs/tree/main?tab=readme-ov-file#for-musicians) ูุจู ุงุณุชุฎุฏุงู ุงูููุชุทู ุงูุชุงูู:  

```python
from demucs import pretrained
from demucs.apply import apply_model
from demucs.audio import convert_audio
import torch


wav = torch.tensor(sample["array"]).to(torch.float32)

demucs = pretrained.get_model('htdemucs')

wav = convert_audio(wav[None], sample["sampling_rate"], demucs.samplerate, demucs.audio_channels)
wav = apply_model(demucs, wav[None])
```  

ุจุนุฏ ุฐููุ ููููู ุงุณุชุฎุฏุงู ุงูููุชุทู ุงูุชุงูู ูุชูููุฏ ุงูููุณููู:  

```python
>>> from transformers import AutoProcessor, MusicgenMelodyForConditionalGeneration

>>> processor = AutoProcessor.from_pretrained("facebook/musicgen-melody")
>>> model = MusicgenMelodyForConditionalGeneration.from_pretrained("facebook/musicgen-melody")

>>> inputs = processor(
...     audio=wav,
...     sampling_rate=demucs.samplerate,
...     text=["80s blues track with groovy saxophone"],
...     padding=True,
...     return_tensors="pt",
... )
>>> audio_values = model.generate(**inputs, do_sample=True, guidance_scale=3, max_new_tokens=256)
```  

ููููู ุฃูุถูุง ุชูุฑูุฑ ุงูุฅุดุงุฑุฉ ุงูุตูุชูุฉ ูุจุงุดุฑุฉ ุฏูู ุงุณุชุฎุฏุงู Demucsุ ุนูู ุงูุฑุบู ูู ุฃู ุฌูุฏุฉ ุงูุชูููุฏ ูุฏ ุชุชุฏููุฑ:  

```python
>>> from transformers import AutoProcessor, MusicgenMelodyForConditionalGeneration

>>> processor = AutoProcessor.from_pretrained("facebook/musicgen-melody")
>>> model = MusicgenMelodyForConditionalGeneration.from_pretrained("facebook/musicgen-melody")

>>> inputs = processor(
...     audio=sample["array"],
...     sampling_rate=sample["sampling_rate"],
...     text=["80s blues track with groovy saxophone"],
...     padding=True,
...     return_tensors="pt",
... )
>>> audio_values = model.generate(**inputs, do_sample=True, guidance_scale=3, max_new_tokens=256)
```  

ุงูุฅุฎุฑุงุฌ ุงูุตูุชู ุนุจุงุฑุฉ ุนู ูุตูููุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ูู Tensor ุฐุงุช ุงูุดูู `(batch_sizeุ num_channelsุ sequence_length)`. ููุงุณุชูุงุน ุฅูู ุนููุงุช ุงูุตูุช ุงููููุฏุฉุ ููููู ุชุดุบูููุง ูู ุฏูุชุฑ ููุงุญุธุงุช ipynb:  

```python
from IPython.display import Audio

sampling_rate = model.config.audio_encoder.sampling_rate
Audio(audio_values[0].numpy(), rate=sampling_rate)
```  

ุฃู ุญูุธูุง ูููู `.wav` ุจุงุณุชุฎุฏุงู ููุชุจุฉ ุฎุงุฑุฌูุฉุ ุนูู ุณุจูู ุงููุซุงู `soundfile`:  

```python
>>> import soundfile as sf

>>> sampling_rate = model.config.audio_encoder.sampling_rate
>>> sf.write("musicgen_out.wav", audio_values[0].T.numpy(), sampling_rate)
```  

### ุงูุชูููุฏ ุงูุดุฑุทู ุงููุตู ููุท  

ูููู ุงุณุชุฎุฏุงู ููุณ [`MusicgenMelodyProcessor`] ููุนุงูุฌุฉ ุฅุดุงุฑุฉ ูุตูุฉ ููุท.  

```python
>>> from transformers import AutoProcessor, MusicgenMelodyForConditionalGeneration

>>> processor = AutoProcessor.from_pretrained("facebook/musicgen-melody")
>>> model = MusicgenMelodyForConditionalGeneration.from_pretrained("facebook/musicgen-melody")

>>> inputs = processor(
...     text=["80s pop track with bassy drums and synth", "90s rock song with loud guitars and heavy drums"],
...     padding=True,
...     return_tensors="pt",
... )
>>> audio_values = model.generate(**inputs, do_sample=True, guidance_scale=3, max_new_tokens=256)
```  

ูุชู ุงุณุชุฎุฏุงู `guidance_scale` ูู ุงูุชูุฌูู ุงูุญุฑ ููุชุตููู (CFG)ุ ูุงูุฐู ูุญุฏุฏ ูุฒู ุงูููุบุงุฑูุชูุงุช ุงูุดุฑุทูุฉ (ุงูุชู ูุชู ุงูุชูุจุค ุจูุง ูู ูpts ุงููุตูุฉ) ูุงูููุบุงุฑูุชูุงุช ุบูุฑ ุงูุดุฑุทูุฉ (ุงูุชู ูุชู ุงูุชูุจุค ุจูุง ูู ูpt ุบูุฑ ูุดุฑูุท ุฃู 'null'). ูุคุฏู ุงุฑุชูุงุน ูููุงุณ ุงูุชูุฌูู ุฅูู ุชุดุฌูุน ุงููููุฐุฌ ุนูู ุชูููุฏ ุนููุงุช ูุฑุชุจุทุฉ ุงุฑุชุจุงุทูุง ุฃูุซู ุจุงูุฅุดุงุฑุฉ ุงูุดุฑุทูุฉุ ูุนุงุฏุฉ ูุง ูููู ุฐูู ุนูู ุญุณุงุจ ุฌูุฏุฉ ุงูุตูุช ุงูุฑุฏูุฆุฉ. ูุชู ุชูููู CFG ุนู ุทุฑูู ุชุนููู `guidance_scale > 1`. ููุญุตูู ุนูู ุฃูุถู ุงููุชุงุฆุฌุ ุงุณุชุฎุฏู `guidance_scale=3` (ุงูุชุฑุงุถู).  

ููููู ุฃูุถูุง ุงูุชูููุฏ ุจุงูุฏูุนุงุช:  

```python
>>> from transformers import AutoProcessor, MusicgenMelodyForConditionalGeneration
>>> from datasets import load_dataset

>>> processor = AutoProcessor.from_pretrained("facebook/musicgen-melody")
>>> model = MusicgenMelodyForConditionalGeneration.from_pretrained("facebook/musicgen-melody")

>>> # take the first quarter of the audio sample
>>> sample_1 = sample["array"][: len(sample["array"]) // 4]

>>> # take the first half of the audio sample
>>> sample_2 = sample["array"][: len(sample["array"]) // 2]

>>> inputs = processor(
...     audio=[sample_1, sample_2],
...     sampling_rate=sample["sampling_rate"],
...     text=["80s blues track with groovy saxophone", "90s rock song with loud guitars and heavy drums"],
...     padding=True,
...     return_tensors="pt",
... )
>>> audio_values = model.generate(**inputs, do_sample=True, guidance_scale=3, max_new_tokens=256)
```  

### ุงูุชูููุฏ ุบูุฑ ุงูุดุฑุทู  

ูููู ุงูุญุตูู ุนูู ุฅุฏุฎุงูุงุช ุงูุชูููุฏ ุบูุฑ ุงูุดุฑุทู (ุฃู 'null') ูู ุฎูุงู ุทุฑููุฉ [`MusicgenMelodyProcessor.get_unconditional_inputs`]:  

```python
>>> from transformers import MusicgenMelodyForConditionalGeneration, MusicgenMelodyProcessor

>>> model = MusicgenMelodyForConditionalGeneration.from_pretrained("facebook/musicgen-melody")
>>> unconditional_inputs = MusicgenMelodyProcessor.from_pretrained("facebook/musicgen-melody").get_unconditional_inputs(num_samples=1)

>>> audio_values = model.generate(**unconditional_inputs, do_sample=True, max_new_tokens=256)
```  

### ุชูููู ุงูุชูููุฏ  

ูููู ุงูุนุซูุฑ ุนูู ุงููุนููุงุช ุงูุงูุชุฑุงุถูุฉ ุงูุชู ุชุชุญูู ูู ุนูููุฉ ุงูุชูููุฏุ ูุซู ุงูููุฐุฌุฉุ ููููุงุณ ุงูุชูุฌููุ ูุนุฏุฏ ุงูุฑููุฒ ุงููููุฏุฉุ ูู ุชูููู ุงูุชูููุฏ ูููููุฐุฌุ ูุชุญุฏูุซูุง ุญุณุจ ุงูุฑุบุจุฉ:  

```python
>>> from transformers import MusicgenMelodyForConditionalGeneration

>>> model = MusicgenMelodyForConditionalGeneration.from_pretrained("facebook/musicgen-melody")

>>> # ูุญุต ุชูููู ุงูุชูููุฏ ุงูุงูุชุฑุงุถู
>>> model.generation_config

>>> # ุฒูุงุฏุฉ ูููุงุณ ุงูุชูุฌูู ุฅูู 4.0
>>> model.generation_config.guidance_scale = 4.0

>>> # ุชูููู ุงูุทูู ุงูุฃูุตู ุฅูู 256 ุฑูุฒูุง
>>> model.generation_config.max_length = 256
```  

ูุงุญุธ ุฃู ุฃู ุญุฌุฌ ูุชู ุชูุฑูุฑูุง ุฅูู ุทุฑููุฉ ุงูุชูููุฏ ุณุชููู ููุง ุงูุฃุณุจููุฉ ุนูู ุชูู ุงูููุฌูุฏุฉ ูู ุชูููู ุงูุชูููุฏุ ูุฐุง ูุฅู ุชุนููู `do_sample=False` ูู ููุงููุฉ ุงูุชูููุฏ ุณุชููู ููุง ุงูุฃุณุจููุฉ ุนูู ุฅุนุฏุงุฏ `model.generation_config.do_sample` ูู ุชูููู ุงูุชูููุฏ.
## ุจููุฉ ุงููููุฐุฌ

ูููู ุชูููู ูููุฐุฌ MusicGen ุฅูู ุซูุงุซ ูุฑุงุญู ูููุฒุฉ:

1. **ุชุฑููุฒ ุงููุต**: ูููู ุจุชุฑููุฒ ูุฏุฎูุงุช ุงููุต ุฅูู ุชุณูุณู ูู ุงูุชูุซููุงุช ุงููุฎููุฉ. ุชุณุชุฎุฏู ุงูููุงุฐุฌ ุงูููุฏุฑุจุฉ ูุณุจููุง ูู MusicGen ุชุฑููุฒ ูุต ูุฌูุฏูุง ุฅูุง ูู T5 ุฃู Flan-T5.

2. **ูู ุชุดููุฑ MusicGen Melody**: ูููุฐุฌ ูุบุฉ ูููู ุจุชูููุฏ ุฑููุฒ ุตูุชูุฉ (ุฃู ุฃููุงุฏ) ุจุดูู ุชููุงุฆู ุชูุงุฒูู ูุดุฑูุท ุจุชูุซููุงุช ุงูุญุงูุฉ ุงููุฎููุฉ ููุชุฑููุฒ.

3. **ูู ุชุดููุฑ ุงูุตูุช**: ูุณุชุฎุฏู ูุงุณุชุนุงุฏุฉ ุงูููุฌุงุช ุงูุตูุชูุฉ ูู ุงูุฑููุฒ ุงูุตูุชูุฉ ุงูุชู ูุชูุจุฃ ุจูุง ูู ุงูุชุดููุฑ.

ูุจุงูุชุงููุ ูููู ุงุณุชุฎุฏุงู ูููุฐุฌ MusicGen ุฅูุง ููููุฐุฌ ูู ุชุดููุฑ ูุณุชููุ ูุงูุฐู ูุชูุงูู ูุน ุงููุฆุฉ [`MusicgenMelodyForCausalLM`]ุ ุฃู ููููุฐุฌ ูุฑูุจ ูุดูู ุชุฑููุฒ ุงููุต ููู ุชุดููุฑ ุงูุตูุชุ ูุงูุฐู ูุชูุงูู ูุน ุงููุฆุฉ [`MusicgenMelodyForConditionalGeneration`]. ุฅุฐุง ูุงู ุงูุฃูุฑ ูุชุทูุจ ููุท ุชุญููู ูู ุงูุชุดููุฑ ูู ููุทุฉ ุงูุชูุชูุด ุงูููุฏุฑุจุฉ ูุณุจููุงุ ููููู ุชุญูููู ุฃููุงู ุนู ุทุฑูู ุชุญุฏูุฏ ุงูุชูููู ุงูุตุญูุญุ ุฃู ุงููุตูู ุฅููู ูู ุฎูุงู ุณูุฉ `.decoder` ูููููุฐุฌ ุงููุฑูุจ:

```python
>>> from transformers import AutoConfig, MusicgenMelodyForCausalLM, MusicgenMelodyForConditionalGeneration

>>> # ุงูุฎูุงุฑ 1: ุงูุญุตูู ุนูู ุชูููู ูู ุงูุชุดููุฑ ูุฅูุฑุงุฑู ุฅูู `.from_pretrained`
>>> decoder_config = AutoConfig.from_pretrained("facebook/musicgen-melody").decoder
>>> decoder = MusicgenMelodyForCausalLM.from_pretrained("facebook/musicgen-melody", **decoder_config.to_dict())

>>> # ุงูุฎูุงุฑ 2: ุชุญููู ุงููููุฐุฌ ุงููุฑูุจ ุจุงููุงููุ ูููู ุฅุฑุฌุงุน ูู ุงูุชุดููุฑ ููุท
>>> decoder = MusicgenMelodyForConditionalGeneration.from_pretrained("facebook/musicgen-melody").decoder
```

ูุธุฑูุง ูุฃู ููุงุฐุฌ ุชุฑููุฒ ุงููุต ููู ุชุดููุฑ ุงูุตูุช ุชููู ูุฌูุฏุฉ ุฃุซูุงุก ุงูุชุฏุฑูุจุ ููููู ุชุฏุฑูุจ ูู ุชุดููุฑ MusicGen [`MusicgenMelodyForCausalLM`] ุจุดูู ูุณุชูู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูู ุญุงูุงุช ุงูุชุฑููุฒ ุงููุฎููุฉ ูุฑููุฒ ุงูุตูุช. ุจุงููุณุจุฉ ููุงุณุชุฏูุงูุ ูููู ุฏูุฌ ูู ุงูุชุดููุฑ ุงููุฏุฑุจ ูุน ุชุฑููุฒ ุงููุต ุงููุฌูุฏ ููู ุชุดููุฑ ุงูุตูุช ูุงุณุชุนุงุฏุฉ ุงููููุฐุฌ ุงููุฑูุจ [`MusicgenMelodyForConditionalGeneration`].

## ุชุญููู ููุทุฉ ุงูุชูุชูุด

ุจุนุฏ ุชูุฒูู ููุงุท ุงูุชูุชูุด ุงูุฃุตููุฉ ูู [ููุง](https://github.com/facebookresearch/audiocraft/blob/main/docs/MUSICGEN.md#importing--exporting-models)ุ ููููู ุชุญููููุง ุจุงุณุชุฎุฏุงู **ุณูุฑูุจุช ุงูุชุญููู** ุงููุชุงุญ ูู `src/transformers/models/musicgen_melody/convert_musicgen_melody_transformers.py` ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุชุงูู:

```bash
python src/transformers/models/musicgen_melody/convert_musicgen_melody_transformers.py \
--checkpoint="facebook/musicgen-melody" --pytorch_dump_folder /output/path
```

ูุตุงุฆุญ:

- ุชู ุชุฏุฑูุจ MusicGen ุนูู ููุทุฉ ุชูุชูุด Encodec 32 ูููู ูุฑุชุฒ. ูุฌุจ ุงูุชุฃูุฏ ูู ุงุณุชุฎุฏุงู ุฅุตุฏุงุฑ ูุชูุงูู ูู ูููุฐุฌ Encodec.
- ูููู ูุถุน ุฃุฎุฐ ุงูุนููุงุช ุฅูู ุชูุฏูู ูุชุงุฆุฌ ุฃูุถู ูู ุงููุถุน ุงูุฌุดุน - ููููู ุงูุชุจุฏูู ุจูู ูุถุนู ุฃุฎุฐ ุงูุนููุงุช ุจุงุณุชุฎุฏุงู ุงููุชุบูุฑ `do_sample` ูู ุงูููุงููุฉ ุฅูู [`MusicgenMelodyForConditionalGeneration.generate`].

## MusicgenMelodyDecoderConfig

[[autodoc]] MusicgenMelodyDecoderConfig

## MusicgenMelodyProcessor

[[autodoc]] MusicgenMelodyProcessor

- get_unconditional_inputs

## MusicgenMelodyFeatureExtractor

[[autodoc]] MusicgenMelodyFeatureExtractor

- _extract_stem_indices

## MusicgenMelodyConfig

[[autodoc]] MusicgenMelodyConfig

## MusicgenMelodyModel

[[autodoc]] MusicgenMelodyModel

- forward

## MusicgenMelodyForCausalLM

[[autodoc]] MusicgenMelodyForCausalLM

- forward

## MusicgenMelodyForConditionalGeneration

[[autodoc]] MusicgenMelodyForConditionalGeneration

- forward