# SuperPoint

## ูุธุฑุฉ ุนุงูุฉ

ุงูุชูุฑุญ ูููุฐุฌ SuperPoint ูู ุงููุฑูุฉ ุงูุจุญุซูุฉ ุจุนููุงู "SuperPoint: Self-Supervised Interest Point Detection and Description" ูู ูุจู ุฏุงูููู ุฏูุชููุ ูุชููุงุด ูุงููุณูููุชุดุ ูุฃูุฏุฑู ุฑุงุจูููููุชุด.

ูุฐุง ุงููููุฐุฌ ูู ูุชูุฌุฉ ูุชุฏุฑูุจ ุฐุงุชู ุงูุฅุดุฑุงู ูุดุจูุฉ ูุชูุงููุฉ ุชูุงููุง ูููุดู ุนู ููุงุท ุงูุงูุชูุงู ููุตููุง. ููููู ูููููุฐุฌ ุงูุชุดุงู ููุงุท ุงูุงูุชูุงู ุงูุชู ุชุชูุฑุฑ ูู ุชุญูููุงุช ุงูุชุดุงุจู ูุชูููุฑ ูุตู ููู ููุทุฉ. ุงุณุชุฎุฏุงู ุงููููุฐุฌ ูู ุญุฏ ุฐุงุชู ูุญุฏูุฏุ ููููู ูููู ุฃู ูุณุชุฎุฏู ููุณุชุฎูุต ููุฎุตุงุฆุต ููููุงุช ุฃุฎุฑู ูุซู ุชูุฏูุฑ ุงูุชุดุงุจูุ ููุทุงุจูุฉ ุงูุตูุฑุ ููุง ุฅูู ุฐูู.

ููููุง ููู ุงูููุฎุต ุงููุณุชุฎุฑุฌ ูู ุงููุฑูุฉ ุงูุจุญุซูุฉ:

"ุชูุฏู ูุฐู ุงููุฑูุฉ ุฅุทุงุฑูุง ุฐุงุชู ุงูุฅุดุฑุงู ูุชุฏุฑูุจ ูุงุดูุงุช ููุงุท ุงูุงูุชูุงู ูุงููุงุตูุงุช ุงูููุงุณุจุฉ ูุนุฏุฏ ูุจูุฑ ูู ูุดููุงุช ุงูููุฏุณุฉ ูุชุนุฏุฏุฉ ุงููุดุงูุฏุงุช ูู ุฑุคูุฉ ุงูููุจููุชุฑ. ูุนูู ุนูุณ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงููุณุชูุฏุฉ ุฅูู ุงูุฑูุนุ ูุฅู ูููุฐุฌูุง ุงููุชูุงูู ุชูุงููุง ูุนูู ุนูู ุงูุตูุฑ ุจุงูุญุฌู ุงููุงูู ููุญุณุจ ุจุดูู ูุดุชุฑู ููุงูุน ููุงุท ุงูุงูุชูุงู ุนูู ูุณุชูู ุงูุจูุณู ูุงููุงุตูุงุช ุงููุฑุชุจุทุฉ ุจูุง ูู ุชูุฑูุฑ ุฃูุงูู ูุงุญุฏ. ููุฏู ุงูุชูููู ุงูุชุดุงุจููุ ููู ููุฌ ูุชุนุฏุฏ ุงูููุงููุณ ููุชุนุฏุฏ ุงูุชุดุงุจูุงุช ูุชุนุฒูุฒ ูุงุจููุฉ ุชูุฑุงุฑ ูุดู ููุงุท ุงูุงูุชูุงู ูุฅุฌุฑุงุก ุงูุชูููู ุนุจุฑ ุงููุฌุงูุงุช (ุนูู ุณุจูู ุงููุซุงูุ ูู ุงููุฌุงู ุงูุชุฎููู ุฅูู ุงููุงูุนู). ูุนูุฏูุง ูุชู ุชุฏุฑูุจ ูููุฐุฌูุง ุนูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุตูุฑ ุงูุนุงูุฉ MS-COCO ุจุงุณุชุฎุฏุงู ุงูุชูููู ุงูุชุดุงุจููุ ูุฅูู ูุณุชุทูุน ุงูุชุดุงู ูุฌููุนุฉ ุฃูุซุฑ ุซุฑุงุกู ูู ููุงุท ุงูุงูุชูุงู ุจุดูู ูุชูุฑุฑ ููุงุฑูุฉ ุจุงููููุฐุฌ ุงูุนููู ุงููููููู ูุณุจููุง ูุฃู ูุงุดู ุฒูุงูุง ุชูููุฏู ุขุฎุฑ. ููุญูู ุงููุธุงู ุงูููุงุฆู ูุชุงุฆุฌ ุฑุงุฆุฏุฉ ูู ูุฌุงู ุชูุฏูุฑ ุงูุชุดุงุจู ุนูู ูุฌููุนุฉ ุจูุงูุงุช HPatches ุนูุฏ ููุงุฑูุชู ุจููุงุฐุฌ LIFT ูSIFT ูORB."

<img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/transformers/model_doc/superpoint_architecture.png" alt="drawing" width="500"/>

<small>ูุธุฑุฉ ุนุงูุฉ ุนูู SuperPoint. ูุฃุฎูุฐุฉ ูู <a href="https://arxiv.org/abs/1712.07629v4">ุงููุฑูุฉ ุงูุจุญุซูุฉ ุงูุฃุตููุฉ.</a></small>

## ูุตุงุฆุญ ุงูุงุณุชุฎุฏุงู

ูููุง ููู ูุซุงู ุณุฑูุน ุนูู ุงุณุชุฎุฏุงู ุงููููุฐุฌ ูููุดู ุนู ููุงุท ุงูุงูุชูุงู ูู ุตูุฑุฉ:

```python
from transformers import AutoImageProcessor, SuperPointForKeypointDetection
import torch
from PIL import Image
import requests

url = "http://images.cocodataset.org/val2017/000000039769.jpg"
image = Image.open(requests.get(url, stream=True).raw)

processor = AutoImageProcessor.from_pretrained("magic-leap-community/superpoint")
model = SuperPointForKeypointDetection.from_pretrained("magic-leap-community/superpoint")

inputs = processor(image, return_tensors="pt")
outputs = model(**inputs)
```

ุชุญุชูู ุงูุฅุฎุฑุงุฌุงุช ุนูู ูุงุฆูุฉ ุฅุญุฏุงุซูุงุช ููุงุท ุงูุงูุชูุงู ูุน ุฏุฑุฌุงุชูุง ููุตููุง (ูุชุฌู ุจุทูู 256).

ููููู ุฃูุถูุง ุฅุฏุฎุงู ุตูุฑ ูุชุนุฏุฏุฉ ุฅูู ุงููููุฐุฌ. ูุจุณุจุจ ุทุจูุนุฉ SuperPointุ ูุฅุฎุฑุงุฌ ุนุฏุฏ ูุชุบูุฑ ูู ููุงุท ุงูุงูุชูุงูุ ุณุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ุฎุงุตูุฉ ุงูููุงุน (mask) ูุงุณุชุฑุฌุงุน ุงููุนูููุงุช ุงูููุงุจูุฉ:

```python
from transformers import AutoImageProcessor, SuperPointForKeypointDetection
import torch
from PIL import Image
import requests

url_image_1 = "http://images.cocodataset.org/val2017/000000039769.jpg"
image_1 = Image.open(requests.get(url_image_1, stream=True).raw)
url_image_2 = "http://images.cocodataset.org/test-stuff2017/000000000568.jpg"
image_2 = Image.open(requests.get(url_image_2, stream=True).raw)

images = [image_1, image_2]

processor = AutoImageProcessor.from_pretrained("magic-leap-community/superpoint")
model = SuperPointForKeypointDetection.from_pretrained("magic-leap-community/superpoint")

inputs = processor(images, return_tensors="pt")
outputs = model(**inputs)

for i in range(len(images)):
    image_mask = outputs.mask[i]
    image_indices = torch.nonzero(image_mask).squeeze()
    image_keypoints = outputs.keypoints[i][image_indices]
    image_scores = outputs.scores[i][image_indices]
    image_descriptors = outputs.descriptors[i][image_indices]
```

ุจุนุฏ ุฐููุ ููููู ุทุจุงุนุฉ ููุงุท ุงูุงูุชูุงู ุนูู ุงูุตูุฑุฉ ูุชุตูุฑ ุงููุชูุฌุฉ:

```python
import cv2
for keypoint, score in zip(image_keypoints, image_scores):
    keypoint_x, keypoint_y = int(keypoint[0].item()), int(keypoint[1].item())
    color = tuple([score.item() * 255] * 3)
    image = cv2.circle(image, (keypoint_x, keypoint_y), 2, color)
cv2.imwrite("output_image.png", image)
```

ุชูุช ุงููุณุงููุฉ ุจูุฐุง ุงููููุฐุฌ ูู ูุจู [stevenbucaille](https://huggingface.co/stevenbucaille). ููููู ุงูุนุซูุฑ ุนูู ุงูููุฏ ุงูุฃุตูู [ููุง](https://github.com/magicleap/SuperPointPretrainedNetwork).

## ุงูููุงุฑุฏ

ูููุง ููู ูุงุฆูุฉ ุจููุงุฑุฏ Hugging Face ุงูุฑุณููุฉ ูููุงุฑุฏ ุงููุฌุชูุน (ูุดุงุฑ ุฅูููุง ุจุฑูุฒ ๐) ููุณุงุนุฏุชู ูู ุงูุจุฏุก ุจุงุณุชุฎุฏุงู SuperPoint. ุฅุฐุง ููุช ููุชููุง ุจุชูุฏูู ููุฑุฏ ูุฅุฏุฑุงุฌู ููุงุ ููุฑุฌู ูุชุญ ุทูุจ ุณุญุจ (Pull Request) ูุณูููู ุจูุฑุงุฌุนุชู! ูููุถู ุฃู ููุธูุฑ ุงูููุฑุฏ ุดูุฆูุง ุฌุฏูุฏูุง ุจุฏูุงู ูู ุชูุฑุงุฑ ููุฑุฏ ููุฌูุฏ.

- ูููู ุงูุนุซูุฑ ุนูู ุฏูุชุฑ ููุงุญุธุงุช ููุธูุฑ ุงูุงุณุชูุชุงุฌ ูุงูุชุตูุฑ ุจุงุณุชุฎุฏุงู SuperPoint [ููุง](https://github.com/NielsRogge/Transformers-Tutorials/blob/master/SuperPoint/Inference_with_SuperPoint_to_detect_interest_points_in_an_image.ipynb). ๐

## SuperPointConfig

[[autodoc]] SuperPointConfig

## SuperPointImageProcessor

[[autodoc]] SuperPointImageProcessor

- preprocess

## SuperPointForKeypointDetection

[[autodoc]] SuperPointForKeypointDetection

- forward