# FocalNet

## نظرة عامة

اقترح نموذج FocalNet في ورقة "Focal Modulation Networks" من قبل Jianwei Yang و Chunyuan Li و Xiyang Dai و Lu Yuan و Jianfeng Gao.

يستبدل FocalNets تمامًا آلية التحويل الذاتي (المستخدمة في نماذج مثل [ViT](vit) و [Swin](swin)) بآلية تعديل بؤري لنمذجة تفاعلات الرموز في الرؤية.

يدعي المؤلفون أن FocalNets تتفوق على النماذج المستندة إلى التحويل الذاتي بتكاليف حسابية مماثلة في مهام تصنيف الصور وكشف الأشياء والتجزئة.

الملخص من الورقة هو ما يلي:

*نقترح شبكات التعديل البؤري (FocalNets اختصارًا)، حيث يتم استبدال التحويل الذاتي (SA) تمامًا بآلية تعديل بؤري لنمذجة تفاعلات الرموز في الرؤية. يتكون التعديل البؤري من ثلاثة مكونات: (1) السياق الهرمي، الذي يتم تنفيذه باستخدام مكدس من طبقات التجزئة المجمعة، لترميز السياقات المرئية من النطاقات القصيرة إلى الطويلة، (2) التجميع المحكوم لجمع السياقات بشكل انتقائي لكل رمز استعلام بناءً على محتواه، و (3) التعديل العنصري أو التحول المائل لحقن السياق المجمع في الاستعلام. تُظهر التجارب المستفيضة أن FocalNets تتفوق على نظيراتها الرائدة في مجال التحويل الذاتي (مثل Swin و Focal Transformers) بتكاليف حسابية مماثلة في مهام تصنيف الصور وكشف الأشياء والتجزئة. على وجه التحديد، تحقق FocalNets بحجم صغير وقياسي 82.3٪ و 83.9٪ من الدقة العليا على ImageNet-1K. بعد التدريب المسبق على ImageNet-22K في دقة 224، فإنه يحقق 86.5٪ و 87.3٪ من الدقة العليا عند ضبط دقة 224 و 384، على التوالي. عند نقلها إلى مهام المصب، تُظهر FocalNets تفوقًا واضحًا. بالنسبة لكشف الأشياء باستخدام Mask R-CNN، تتفوق FocalNet base المدربة على 1x على نظيرتها Swin بمقدار 2.1 نقطة وتتفوق بالفعل على Swin المدربة على جدول 3x (49.0 مقابل 48.5). بالنسبة للتجزئة الدلالية باستخدام UPerNet، تتفوق FocalNet base ذات المقياس الفردي على Swin بمقدار 2.4، وتتغلب على Swin في المقياس المتعدد (50.5 مقابل 49.7). باستخدام FocalNet كبيرة و Mask2former، نحقق 58.5 mIoU لتجزئة ADE20K الدلالية، و 57.9 PQ لتجزئة COCO Panoptic. باستخدام FocalNet كبيرة و DINO، حققنا 64.3 و 64.4 mAP على COCO minival و test-dev، على التوالي، مما يحدد حالة جديدة من الفن على رأس نماذج أكبر بكثير تعتمد على الانتباه مثل Swinv2-G و BEIT-3.*

تمت المساهمة بهذا النموذج من قبل [nielsr](https://huggingface.co/nielsr).

يمكن العثور على الكود الأصلي [هنا](https://github.com/microsoft/FocalNet).

## FocalNetConfig

[[autodoc]] FocalNetConfig

## FocalNetModel

[[autodoc]] FocalNetModel

- forward

## FocalNetForMaskedImageModeling

[[autodoc]] FocalNetForMaskedImageModeling

- forward

## FocalNetForImageClassification

[[autodoc]] FocalNetForImageClassification

- forward