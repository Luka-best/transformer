# ูุญูู ุงููุฎุทุท ุงูุทููู ุงูุตูุชู Audio Spectrogram Transformer

## ูุธุฑุฉ ุนุงูุฉ

ุงูุชุฑุญ ูููุฐุฌ ูุญูู ุงููุฎุทุท ุงูุทููู ุงูุตูุชู ูู [AST: Audio Spectrogram Transformer](https://arxiv.org/abs/2104.01778) ูู ูุจู ููุงู ุบููุบุ ููู-ุขู ุชุดููุบุ ูุฌููุณ ุฌูุงุณ.

ูุทุจู ูุญูู ุงููุฎุทุท ุงูุทููู ุงูุตูุชู [ูุญูู ุงูุฑุคูุฉ](vit) ุนูู ุงูุตูุชุ ุนู ุทุฑูู ุชุญููู ุงูุตูุช ุฅูู ุตูุฑุฉ (ูุฎุทุท ุทููู). ููุญุตู ุงููููุฐุฌ ุนูู ูุชุงุฆุฌ ูุชูุฏูุฉ ูู ุชุตููู ุงูุตูุช.

ุงูููุฎุต ูู ุงููุฑูุฉ ูู ููุง ููู:

*ูู ุงูุนูุฏ ุงููุงุถูุ ุชู ุงุนุชูุงุฏ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ (CNNs) ุนูู ูุทุงู ูุงุณุน ููุชูุฉ ุจูุงุก ุฑุฆูุณูุฉ ูููุงุฐุฌ ุชุตููู ุงูุตูุช ูู ุงูุจุฏุงูุฉ ุฅูู ุงูููุงูุฉุ ูุงูุชู ุชูุฏู ุฅูู ุชุนูู ุฎุฑูุทุฉ ูุจุงุดุฑุฉ ูู ุงููุฎุทุทุงุช ุงูุทูููุฉ ุงูุตูุชูุฉ ุฅูู ุงูุนูุงูุงุช ุงูููุงุจูุฉ. ูููุชูุงุท ุงูุณูุงู ุงูุนุงููู ุทููู ุงููุฏู ุจุดูู ุฃูุถูุ ููุงู ุงุชุฌุงู ุญุฏูุซ ูุชูุซู ูู ุฅุถุงูุฉ ุขููุฉ ุงูุชูุงู ุฐุงุชู ุนูู ุฑุฃุณ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงูุชูุงููููุฉุ ููุง ูุดูู ูููุฐุฌ ุชูุฌูู ุจูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ูุงูุงูุชูุงู. ููุน ุฐููุ ููู ุบูุฑ ุงููุงุถุญ ูุง ุฅุฐุง ูุงู ุงูุงุนุชูุงุฏ ุนูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุถุฑูุฑููุงุ ูุฅุฐุง ูุงูุช ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชู ุชุนุชูุฏ ููุท ุนูู ุงูุงูุชูุงู ูุงููุฉ ููุญุตูู ุนูู ุฃุฏุงุก ุฌูุฏ ูู ุชุตููู ุงูุตูุช. ูู ูุฐู ุงููุฑูุฉุ ูุฌูุจ ุนูู ูุฐุง ุงูุณุคุงู ูู ุฎูุงู ุชูุฏูู ูุญูู ุงููุฎุทุท ุงูุทููู ุงูุตูุชู (AST)ุ ููู ุฃูู ูููุฐุฌ ุฎุงูู ูู ุงูุชูุงููู ููุงุฆู ุนูู ุงูุงูุชูุงู ููุท ูุชุตููู ุงูุตูุช. ูููู ุจุชูููู AST ุนูู ูุนุงููุฑ ุชุตููู ุงูุตูุช ุงููุฎุชููุฉุ ุญูุซ ูุญูู ูุชุงุฆุฌ ุฌุฏูุฏุฉ ูุชูุฏูุฉ ุชุจูุบ 0.485 mAP ุนูู AudioSetุ ู95.6% ุฏูุฉ ุนูู ESC-50ุ ู98.1% ุฏูุฉ ุนูู Speech Commands V2.*

<img src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/transformers/model_doc/audio_spectogram_transformer_architecture.png" alt="drawing" width="600"/>

<small> ุจููุฉ ูุญูู ุงููุฎุทุท ุงูุทููู ุงูุตูุชู. ูุฃุฎูุฐุฉ ูู <a href="https://arxiv.org/abs/2104.01778">ุงููุฑูุฉ ุงูุฃุตููุฉ</a>.</small>

ุชูุช ุงููุณุงููุฉ ุจูุฐุง ุงููููุฐุฌ ูู ูุจู [nielsr](https://huggingface.co/nielsr).

ูููู ุงูุนุซูุฑ ุนูู ุงูููุฏ ุงูุฃุตูู [ููุง](https://github.com/YuanGongND/ast).

## ูุตุงุฆุญ ุงูุงุณุชุฎุฏุงู

- ุนูุฏ ุถุจุท ูููุฐุฌ ูุญูู ุงููุฎุทุท ุงูุทููู ุงูุตูุชู (AST) ุนูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุ ููุตู ุจุงูุงูุชูุงู ุจุชุทุจูุน ุงูุฅุฏุฎุงู (ููุชุฃูุฏ ูู ุฃู ุงูุฅุฏุฎุงู ูู ูุชูุณุท 0 ูุงูุญุฑุงู ูุนูุงุฑู 0.5). ููุชููู [`ASTFeatureExtractor`] ุงูุนูุงูุฉ ุจูุฐุง. ูุงุญุธ ุฃูู ูุณุชุฎุฏู ูุชูุณุท โโููุฌููุนุฉ AudioSet ุจุดูู ุงูุชุฑุงุถู. ููููู ุงูุชุญูู ูู [`ast/src/get_norm_stats.py`](https://github.com/YuanGongND/ast/blob/master/src/get_norm_stats.py) ููุนุฑูุฉ ููููุฉ ุญุณุงุจ ุงููุคูููู ููุฅุญุตุงุกุงุช ููุฌููุนุฉ ุจูุงูุงุช ุฃุณูู ุงูุจุซ.

- ูุงุญุธ ุฃู AST ูุญุชุงุฌ ุฅูู ูุนุฏู ุชุนูู ููุฎูุถ (ูุณุชุฎุฏู ุงููุคูููู ูุนุฏู ุชุนูู ุฃูู ุจุนุดุฑ ูุฑุงุช ููุงุฑูุฉ ุจูููุฐุฌ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุงูุฐู ุงูุชุฑุญูู ูู ูุฑูุฉ [PSLA](https://arxiv.org/abs/2102.01243)) ููุตู ุฅูู ุงูุชูุงุฑุจ ุจุณุฑุนุฉุ ูุฐุง ูุฑุฌู ุงูุจุญุซ ุนู ูุนุฏู ุชุนูู ููุงุณุจ ููุฎุทุท ุฌุฏููุฉ ูุนุฏู ุงูุชุนูู ููููุชู.

### ุงุณุชุฎุฏุงู ุงูุงูุชุจุงู ุงูููุชุฌ ุงููุฑุฌุญ ุจุงูุจูุนุฉ (SDPA)

ุชุชุถูู PyTorch ูุดุบู ุงูุชูุงู ููุชุฌ ูุฑุฌุญ ุจุงูุจูุนุฉ (SDPA) ุฃุตูู ูุฌุฒุก ูู `torch.nn.functional`. ุชุดูู ูุฐู ุงููุธููุฉ ุนุฏุฉ ุชุทุจููุงุช ูููู ุชุทุจูููุง ุงุนุชูุงุฏูุง ุนูู ุงูุฅุฏุฎุงูุงุช ูุงูุฃุฌูุฒุฉ ุงููุณุชุฎุฏูุฉ. ุฑุงุฌุน [ุงููุซุงุฆู ุงูุฑุณููุฉ](https://pytorch.org/docs/stable/generated/torch.nn.functional.scaled_dot_product_attention.html) ุฃู ุตูุญุฉ [GPU Inference](https://huggingface.co/docs/transformers/main/en/perf_infer_gpu_one#pytorch-scaled-dot-product-attention) ููุฒูุฏ ูู ุงููุนูููุงุช.

ูุชู ุงุณุชุฎุฏุงู SDPA ุจุดูู ุงูุชุฑุงุถู ูู `torch>=2.1.1` ุนูุฏูุง ูููู ุงูุชูููุฐ ูุชุงุญูุงุ ูููู ููููู ุฃูุถูุง ุชุนููู `attn_implementation="sdpa"` ูู `from_pretrained()` ูุทูุจ ุงุณุชุฎุฏุงู SDPA ุจุดูู ุตุฑูุญ.

```
from transformers import ASTForAudioClassification
model = ASTForAudioClassification.from_pretrained("MIT/ast-finetuned-audioset-10-10-0.4593", attn_implementation="sdpa", torch_dtype=torch.float16)
...
```

ููุญุตูู ุนูู ุฃูุถู ุงูุชุญุณููุงุชุ ููุตู ุจุชุญููู ุงููููุฐุฌ ุจูุตู ุงูุฏูุฉ (ุนูู ุณุจูู ุงููุซุงู `torch.float16` ุฃู `torch.bfloat16`).

ูู ูุนูุงุฑ ูุญูู (A100-40GBุ PyTorch 2.3.0ุ OS Ubuntu 22.04) ูุน `float32` ููููุฐุฌ `MIT/ast-finetuned-audioset-10-10-0.4593`ุ ุฑุฃููุง ุงูุชุญุณููุงุช ุงูุชุงููุฉ ุฃุซูุงุก ุงูุงุณุชุฏูุงู.

| ุญุฌู ุงูุฏูุนุฉ | ูุชูุณุท โโููุช ุงูุงุณุชุฏูุงู (ูููู ุซุงููุฉ)ุ ูุถุน ุงูุชูููู | ูุชูุณุท โโููุช ุงูุงุณุชุฏูุงู (ูููู ุซุงููุฉ)ุ ูููุฐุฌ SDPA | ุชุณุฑูุนุ SDPA / Eager (x) |
|--------------|-------------------------------------------|-------------------------------------------|------------------------------|
| 1 | 27 | 6 | 4.5 |
| 2 | 12 | 6 | 2 |
| 4 | 21 | 8 | 2.62 |
| 8 | 40 | 14 | 2.86 |

## ุงูููุงุฑุฏ

ูุงุฆูุฉ ุจููุงุฑุฏ Hugging Face ุงูุฑุณููุฉ ูููุงุฑุฏ ุงููุฌุชูุน (ุงููุดุงุฑ ุฅูููุง ุจู ๐) ููุณุงุนุฏุชู ูู ุงูุจุฏุก ุจุงุณุชุฎุฏุงู ูุญูู ุงููุฎุทุท ุงูุทููู ุงูุตูุชู.

<PipelineTag pipeline="audio-classification"/>

- ูููู ุงูุนุซูุฑ ุนูู ุฏูุชุฑ ููุงุญุธุงุช ููุถุญ ุงูุงุณุชุฏูุงู ุจุงุณุชุฎุฏุงู AST ูุชุตููู ุงูุตูุช [ููุง](https://github.com/NielsRogge/Transformers-Tutorials/tree/master/AST).
- ูุชู ุฏุนู [`ASTForAudioClassification`] ุจูุงุณุทุฉ [ูุต ุจุฑูุฌู ุชูุถูุญู](https://github.com/huggingface/transformers/tree/main/examples/pytorch/audio-classification) ู [ุฏูุชุฑ ููุงุญุธุงุช](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/audio_classification.ipynb).
- ุฑุงุฌุน ุฃูุถูุง: [ุชุตููู ุงูุตูุช](../tasks/audio_classification).

ุฅุฐุง ููุช ููุชููุง ุจุชูุฏูู ููุฑุฏ ูุฅุฏุฑุงุฌู ููุงุ ูุงูุฑุฌุงุก ูุชุญ ุทูุจ ุณุญุจ ูุณูุฑุงุฌุนู! ูุฌุจ ุฃู ููุถุญ ุงูููุฑุฏ ุจุดูู ูุซุงูู ุดูุฆูุง ุฌุฏูุฏูุง ุจุฏูุงู ูู ุชูุฑุงุฑ ููุฑุฏ ููุฌูุฏ.

## ASTConfig

[[autodoc]] ASTConfig

## ASTFeatureExtractor

[[autodoc]] ASTFeatureExtractor

- __call__

## ASTModel

[[autodoc]] ASTModel

- forward

## ASTForAudioClassification

[[autodoc]] ASTForAudioClassification

- forward